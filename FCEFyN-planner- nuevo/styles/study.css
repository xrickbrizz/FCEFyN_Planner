/* =========================================================
   Layout
   ========================================================= */
   #logoPanel{
    width: 11rem;
    cursor:auto;
   }
header{
  position: relative;
  padding: 1rem 1.3rem;
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap: .8rem;
  border-bottom:1px solid var(--border-75);
  backdrop-filter: blur(10px);
  z-index: 100;
}
body.light-mode header,
body[data-theme="light"] header{
  background:var(--surface-3);
  border-bottom:1px solid var(--color-border);
  box-shadow:none;
  backdrop-filter:none;
}
.header-left{ display:flex; flex-direction:column; gap:.15rem; }
.header-title{ font-size:1.3rem; font-weight:700; letter-spacing:.12px; line-height:1.2; }
.header-sub{ font-size:.87rem; color:var(--muted); }
.header-right{ display:flex; align-items:center; gap:.75rem; flex-wrap:wrap; justify-content:flex-end; }
.user-panel{
  position:relative;
  display:flex;
  align-items:center;
  z-index: 1000;
}
.user-avatar{
  width: 3.125rem;
  height: 3.125rem;
  padding: 0;
  border-radius: 62.438rem;
  border:1px solid var(--border-85);
  background:var(--surface-94);
  box-shadow:none;
  display:inline-flex;
  align-items:center;
  justify-content:center;
}
.user-avatar img{
  width: 100%;
  height: 100%;
  border-radius: inherit;
  object-fit:cover;
  display:block;
}
.user-menu{
  position:absolute;
  right: 0;
  top: calc(100% + .55rem);
  min-width: 11.875rem;
  background:var(--surface-94);
  border:1px solid var(--border-80);
  border-radius: var(--radius-lg);
  padding: .35rem;
  box-shadow:none;
  opacity:0;
  transform:translateY(-8px);
  pointer-events:none;
  transition:opacity var(--transition-fast), transform var(--transition-fast);
  z-index:40;
}
.user-menu::before{
  content:"";
  position:absolute;
  top: -0.375rem;
  right: 1.125rem;
  width: 0.75rem;
  height: 0.75rem;
  background:var(--surface-94);
  border-left:1px solid var(--border-60);
  border-top:1px solid var(--border-60);
  transform:rotate(45deg);
}
.user-panel.open .user-menu{
  opacity:1;
  transform:translateY(0);
  pointer-events:auto;
}
.user-menu button,
.user-menu a{
  width: 100%;
  border:none;
  background:transparent;
  padding: .55rem .7rem;
  border-radius: var(--radius-md);
  color:var(--color-text);
  font-size: .9rem;
  text-align:left;
  display:flex;
  align-items:center;
  gap: .5rem;
  cursor:pointer;
}
.user-menu button:hover,
.user-menu a:hover{
  background:var(--accent-12);
}
.user-menu .menu-icon{
  font-size: 1rem;
  width: 1.1rem;
  text-align:center;
}
.account-box{
  padding: .55rem .85rem;
  border-radius: var(--radius-lg);
  background:var(--surface-94);
  border:1px solid var(--border-85);
  display:flex;
  flex-direction:column;
  gap: .12rem;
  min-width: 15rem;
  box-shadow:none;
}
.account-label{ font-size:.76rem; color:var(--muted); letter-spacing:.1px; }
.account-email{
  font-size: .88rem;
  color:var(--color-text);
  max-width: 16.25rem;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
}

button{
  padding: .48rem 1.05rem;
  border:none;
  border-radius: var(--radius-md);
  cursor:pointer;
  font-size: .92rem;
  font-weight:500;
  line-height:1.25;
  transition: transform var(--transition-fast), filter var(--transition-fast), box-shadow var(--transition-fast);
  user-select:none;
  letter-spacing: .02em;
}
.btn-blue{
  color:var(--color-primary-strong);
  box-shadow:var(--shadow-btn);
}
.btn-blue:hover{ filter:brightness(1.05); transform:translateY(-1px); }
.btn-gray{ background:var(--color-surface-2); color:var(--color-text); box-shadow:var(--shadow-btn); }
.btn-gray:hover{ filter:brightness(1.05); transform:translateY(-1px); }
.btn-outline{
  background:var(--glass-faint);
  color:var(--color-text);
  border:1px solid var(--border-90);
  box-shadow:var(--shadow-btn);
}
.btn-outline:hover{ border-color:var(--accent-805); }
.btn-danger{ background:var(--color-danger); color:var(--color-text-contrast);}
.btn-small{ padding:.24rem .68rem; font-size:.8rem; border-radius:var(--radius-sm);box-shadow: none; }

body.dark-mode .btn-blue,
body[data-theme="dark"] .btn-blue{
  background:var(--surface-9);
  color:var(--color-primary-strong);
  border:1px solid var(--inverse-70);
  border-radius: var(--radius-pill);
  box-shadow:none;
}
body.dark-mode .btn-blue:active,
body[data-theme="dark"] .btn-blue:active{
  transform:scale(0.98);
}
body.dark-mode .btn-gray,
body[data-theme="dark"] .btn-gray{
  background:var(--inverse-04);
  color:var(--color-text);
  border:1px solid var(--inverse-10);
  box-shadow:none;
}
body.dark-mode .btn-outline,
body[data-theme="dark"] .btn-outline{
  background:transparent;
  border-color:var(--inverse-12);
  box-shadow:none;
}

.section-label{
  display:inline-flex;
  align-items:center;
  gap: .55rem;
  font-weight:600;
  letter-spacing: .1px;
  background:var(--card);
  border:1px solid var(--border);
  border-radius: 62.438rem;
  padding: .55rem 1rem;
  color:var(--text);
  box-shadow:none;
  width: fit-content;
}
body.dark-mode .section-label,
body[data-theme="dark"] .section-label{
  background:var(--card);
  border-color:var(--border);
  box-shadow:none;
}

.content-header{
  display:grid;
  grid-template-columns:auto 1fr auto;
  align-items:center;
  gap: .75rem;
  position:static;
  top: 0;
  z-index:12;
  padding: .35rem .5rem;
  background:var(--card);
  border-radius: var(--radius);
  border:1px solid var(--border);
  box-shadow:none;
}
.top-actions{
  display:inline-flex;
  align-items:center;
  gap:.5rem;
  position:relative;
}
.heart-toggle-btn{
  font-size:1rem;
  line-height:1;
}
.requests-anchor{
  position:relative;
  display:inline-flex;
}
.dropdown-panel{
  position:absolute;
  top:100%;
  left:50%;
  transform:translateX(-50%);
  margin-top:.45rem;
  width:280px;
  max-height:360px;
  overflow:auto;
  background:var(--card);
  border:1px solid var(--border);
  border-radius:12px;
  box-shadow:0 10px 25px rgba(0,0,0,.12);
  padding:1rem;
  display:none;
  z-index:1000;
}
.dropdown-panel.is-open{
  display:block;
}
.dropdown-panel h4{
  margin:0 0 .5rem;
  font-size:.88rem;
}
.dropdown-requests-list{
  display:flex;
  flex-direction:column;
  gap:.45rem;
  margin-bottom:.85rem;
}
.dropdown-requests-list:last-child{
  margin-bottom:0;
}
.dropdown-request-item{
  padding:.55rem .6rem;
  border:1px solid var(--border);
  border-radius:10px;
  background:var(--surface-2, rgba(255,255,255,.6));
  font-size:.82rem;
}
.dropdown-request-item strong{
  display:block;
  font-size:.84rem;
}
@media (max-width: 768px){
  .dropdown-panel{
    left:0;
    transform:none;
    width:min(86vw, 280px);
    max-height:60vh;
  }
}
.content-header .section-label{
  justify-self:center;
}
body.dark-mode .content-header,
body[data-theme="dark"] .content-header{
  background:var(--surface-92);
  border-color:var(--inverse-08);
  box-shadow:none;
}
.help-btn{
  border:1px solid var(--accent-75);
  background:var(--accent-bg);
  color:var(--color-primary-strong);
  width: 2.625rem;
  height: 2.625rem;
  border-radius: var(--radius-md);
  font-weight:800;
  font-size: 1.05rem;
  box-shadow:var(--shadow-btn);
}
body.dark-mode .help-btn,
body[data-theme="dark"] .help-btn{
  background:var(--inverse-06);
  border-color:var(--inverse-14);
  color:var(--color-text);
  box-shadow:none;
}
.help-btn:hover{ filter:brightness(1.05); }

.page-layout{
  --sidebar-expanded:150px;
  --sidebar-collapsed:96px;
  display:grid;
  grid-template-columns:var(--sidebar-expanded) minmax(0,1fr);
  gap: 1.35rem;
  max-width: none;
  width: calc(100% - 2rem);
  align-items:flex-start;
  transition:grid-template-columns .18s ease;
}
.page-layout.sidebar-collapsed{
  grid-template-columns:var(--sidebar-collapsed) minmax(0,1fr);
}
.page-content{
  min-width: 0;
  display:flex;
  flex-direction:column;
  margin: 0;
  padding: 0;
  gap: .75rem;
}
.main-shell{
  max-width: none;
  width: 100%;
  margin: 0;
  padding: 0;
}
.main-shell > .tab-card{
  width: 100%;
}

@media(max-width:1024px){
  .page-layout{ grid-template-columns:1fr; width:calc(100% - 1.6rem); padding:0 .8rem; }
}

    .tabs-bar{
      display:flex;
      gap: .5rem;
      margin-bottom:1rem;
      flex-wrap:wrap;
      align-items:center;
    }
.tab-btn{
  flex:0 0 auto;
  padding: .5rem 1rem;
  border-radius: var(--radius-lg);
  background:var(--surface-94);
  color:var(--color-text);
  border:1px solid var(--border-85);
  font-size: .9rem;
  font-weight:500;
  line-height:1.25;
  box-shadow:none;
  letter-spacing: .02em;
}
.tab-btn.tab-active{
  background:var(--btn-primary-bg);
  border-color:var(--accent-805);
  box-shadow:none;
  color:var(--color-primary-strong);
  font-weight:700;
}
body.dark-mode .tab-btn,
body[data-theme="dark"] .tab-btn{
  background:var(--inverse-04);
  border-color:var(--inverse-10);
  box-shadow:none;
}
body.dark-mode .tab-btn.tab-active,
body[data-theme="dark"] .tab-btn.tab-active{
  background:var(--surface-9);
  color:var(--color-primary-strong);
  border-color:var(--inverse-70);
  box-shadow:none;
}
body.light-mode .tab-btn,
body[data-theme="light"] .tab-btn{
  background:var(--surface-3);
  border-color: var(--color-border);
  box-shadow:none;
}
body.light-mode .tab-btn.tab-active,
body[data-theme="light"] .tab-btn.tab-active{
  background:var(--btn-primary-bg);
  color:var(--surface-3);
  border-color:transparent;
  box-shadow:none;
}

.tab-card{
  background: var(--surface-98);
  border-radius: var(--radius-2xl);
  padding: 1.05rem;
  box-shadow:none;
  border:1px solid var(--border-30);
  backdrop-filter: blur(8px);
}
body.light-mode .tab-card,
body[data-theme="light"] .tab-card{
  background:var(--surface-3);
  border-color: var(--color-border);
  box-shadow:none;
  backdrop-filter:none;
}


.coming-view{
  min-height: calc(100vh - 16.25rem);
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  text-align:center;
  gap: .6rem;
  padding: 1.2rem;
}
.coming-illustration{
  width: min(100%, 22.5rem);
  color:var(--color-text);
}
.coming-illustration svg{
  width: 100%;
  height: auto;
  display:block;
}
.coming-view h2{
  margin: .2rem 0 0;
  font-size: clamp(2rem, 2.8vw, 2.6rem);
  line-height: 1.12;
  color:var(--color-primary-strong);
}
.coming-view p{
  margin: 0;
  max-width: 38.75rem;
  color:var(--text-soft);
  font-size: 1.03rem;
  line-height: 1.45;
}
@media (max-width: 900px){
  .coming-view{
    min-height: calc(100vh - 13.75rem);
    padding: 1rem .7rem;
  }
  .coming-illustration{
    width: min(100%, 18.75rem);
  }
}
    .home-layout{
      display:grid;
      grid-template-columns:minmax(0,2.1fr) minmax(0,1fr);
      gap: 1rem;
      align-items:stretch;
      min-height: calc(100vh - 14.375rem);
    }
    @media(max-width:1100px){
      .home-layout{ grid-template-columns:1fr; min-height:auto; }
    }
    .home-title{ margin:0.1rem 0; font-size:1.6rem; font-weight:700; line-height:1.2; letter-spacing:-0.01em; }
    .home-sub{
      color:var(--text-soft);
      max-width: 48.75rem;
      line-height: 1.55;
    }
    .home-cards{
      margin-top:1.1rem;
      display:grid;
      gap: .85rem;
      grid-template-columns:repeat(3, minmax(0,1fr));
      grid-auto-rows:1fr;
    }
    @media(max-width:1024px){
      .home-cards{ grid-template-columns:repeat(2, minmax(0,1fr)); }
    }
    @media(max-width:720px){
      .home-cards{ grid-template-columns:1fr; }
    }
    .home-card{
      position:relative;
      display:flex;
      gap: .75rem;
      align-items:flex-start;
      width:100%;
      height:100%;
      text-align:left;
      background:#fff;
      border:1px solid var(--border-30);
      border-radius: var(--radius-lg);
      padding: .9rem;
      box-shadow:0 8px 22px rgba(15, 23, 42, 0.05);
      font-family:inherit;
      color:inherit;
      transition:transform var(--transition-fast), box-shadow var(--transition-fast), border-color var(--transition-fast);
    }
    .home-card[data-coming-soon="false"]{
      cursor:pointer;
    }
    .home-card[data-coming-soon="false"]:hover{
      transform:translateY(-2px);
      box-shadow:0 14px 28px rgba(15, 23, 42, 0.1);
      border-color:var(--border-40);
    }
    .home-card[data-coming-soon="false"]:focus-visible{
      outline:2px solid var(--color-primary);
      outline-offset:2px;
    }
    .home-card[data-coming-soon="true"]{
      opacity:.65;
      cursor:default;
    }
    body.dark-mode .home-card,
    body[data-theme="dark"] .home-card{
      background:var(--surface-92);
      border-color:var(--inverse-10);
      box-shadow:none;
    }
    .home-card-icon{
      width: 2.75rem;
      height: 2.75rem;
      border-radius: 50%;
      background:var(--accent-12);
      border:1px solid var(--accent-35);
      display:flex;
      align-items:center;
      justify-content:center;
      color:var(--color-primary-strong);
      flex:0 0 auto;
    }
    .home-card-icon svg{ width:22px; height:22px; }
    .home-card-body{
      min-width:0;
      display:flex;
      flex-direction:column;
      gap:.2rem;
    }
    .home-card-title{ font-weight:800; margin-bottom:.2rem; }
    .home-card-desc{ color:var(--text-soft); line-height:1.4; }
    .home-card-badge{
      position:absolute;
      top:.55rem;
      right:.55rem;
      border-radius:var(--radius-pill);
      border:1px solid var(--border-30);
      background:var(--surface-3);
      color:var(--text-soft);
      font-size:.72rem;
      font-weight:700;
      padding:.1rem .45rem;
    }

    [hidden]{
      display:none !important;
    }

    .home-notices-panel{
      background:var(--surface-3);
      border:1px solid var(--border-30);
      border-radius: var(--radius-lg);
      padding: .85rem;
      display:flex;
      flex-direction:column;
      gap: .75rem;
      min-height: 0;
      height: 100%;
    }
    .home-notices-panel[data-mode="list"] #homeNoticesDetail{
      display:none !important;
    }
    .home-notices-panel[data-mode="detail"] #homeNoticesListing{
      display:none !important;
    }
    .home-notices-panel[data-mode="detail"] #homeNoticesBack{
      display:inline-flex !important;
    }
    .home-notices-panel[data-mode="list"] #homeNoticesBack{
      display:none !important;
    }
    .home-notices-panel[data-mode="detail"] #homeNoticesSearchWrap{
      display:none !important;
    }
    .home-notices-panel[data-mode="detail"] #homeNoticesNav{
      display:none !important;
    }
    body.dark-mode .home-notices-panel,
    body[data-theme="dark"] .home-notices-panel{
      background:var(--surface-92);
      border-color:var(--inverse-10);
    }
    .home-notices-header{
      display:flex;
      align-items:center;
      gap: .65rem;
      flex-wrap:wrap;
      justify-content:space-between;
    }
    .home-notices-title{
      font-weight:800;
      font-size: 1.05rem;
    }
    .home-notices-listing,
    .home-notices-detail{
      flex:1;
      min-height: 0;
    }
    .home-notices-search{
      display:flex;
      align-items:center;
      gap: .4rem;
      padding: .2rem .25rem .28rem .12rem;
      border-radius: 0.75rem;
      background:transparent;
      border:none;
      border-bottom:1px solid rgba(0,0,0,0.15);
      color:var(--text-soft);
      flex:1 1 180px;
      max-width: 15rem;
      transition:border-color var(--transition-fast);
    }
    body.dark-mode .home-notices-search,
    body[data-theme="dark"] .home-notices-search{
      border-bottom-color:rgba(255,255,255,0.26);
    }
    .home-notices-search:focus-within{
      border-bottom-color:rgba(0,0,0,0.4);
    }
    body.dark-mode .home-notices-search:focus-within,
    body[data-theme="dark"] .home-notices-search:focus-within{
      border-bottom-color:rgba(255,255,255,0.55);
    }
    .home-notices-search input{
      border:none;
      outline:none;
      box-shadow:none;
      appearance:none;
      -webkit-appearance:none;
      background:transparent;
      color:inherit;
      width: 100%;
      font-size: .9rem;
      font-family:inherit;
      padding-left:0;
    }
    .home-search-icon{
      width: 0.875rem;
      height: 0.875rem;
      border-radius: 50%;
      border:2px solid var(--text-soft);
      position:relative;
      display:inline-block;
      flex:0 0 auto;
    }
    .home-search-icon::after{
      content:"";
      position:absolute;
      width: 0.438rem;
      height: 2px;
      background:var(--text-soft);
      right: -0.25rem;
      bottom: -2px;
      transform:rotate(45deg);
      border-radius: 2px;
    }
    .home-notices-nav{
      display:flex;
      align-items:center;
      gap: .35rem;
    }
    .home-notices-range{
      font-size: .85rem;
      color:var(--text-soft);
    }
    .home-notices-btn{
      width: 1.75rem;
      height: 1.75rem;
      border-radius: var(--radius-pill);
      border:1px solid var(--border-30);
      background:var(--surface-5);
      font-size: 1rem;
      color:var(--text);
      display:flex;
      align-items:center;
      justify-content:center;
      transition:filter var(--transition-fast);
    }
    .home-notices-btn:disabled{
      opacity:.45;
      cursor:not-allowed;
    }
    .home-notices-btn:hover:not(:disabled){ filter:brightness(0.98); }
    .home-notices-content{
      flex:1;
      min-height: 0;
      display:flex;
      flex-direction:column;
    }
    .home-notices-list{
      display:flex;
      flex-direction:column;
      gap: .45rem;
      overflow-y:auto;
      padding-right:.2rem;
    }
    .home-notices-empty{
      color:var(--text-soft);
      font-size: .9rem;
      padding: .6rem 0;
    }
    .home-notice-item{
      display:grid;
      grid-template-columns:minmax(0,1fr) auto;
      gap: .6rem;
      padding: .6rem .7rem;
      border-radius: var(--radius-md);
      border:1px solid var(--border-18);
      background:var(--glass-faint);
      text-align:left;
      cursor:pointer;
      transition:border-color var(--transition-fast);
      font-family:inherit;
      color:var(--text);
    }
    .home-notice-item:hover{ border-color:var(--border-40); }
    .home-notice-title-row{
      display:flex;
      align-items:center;
      gap: .4rem;
      margin-bottom:.2rem;
    }
    .home-notice-preview{
      color:var(--text-soft);
      font-size: .85rem;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .home-notice-meta{
      font-size: .82rem;
      color:var(--text-soft);
      display:flex;
      align-items:flex-start;
      justify-content:flex-end;
      min-width: 3.75rem;
    }
    .notice-pin{
      width: 0.75rem;
      height: 0.75rem;
      border-radius: 50% 50% 50% 0;
      border:2px solid var(--text-soft);
      transform:rotate(-45deg);
      position:relative;
      flex:0 0 auto;
    }
    .notice-pin::after{
      content:"";
      position:absolute;
      width: 2px;
      height: 0.375rem;
      background:var(--text-soft);
      left: 0.25rem;
      top: 0.438rem;
      border-radius: 2px;
    }

    .home-notices-detail{
      display:flex;
      flex-direction:column;
      gap: .75rem;
      min-height: 0;
    }
    .home-notices-back{
      align-self:flex-start;
      border:none;
      background:none;
      color:var(--text);
      font-weight:700;
      cursor:pointer;
      padding: 0;
      font-size: .95rem;
      display:inline-flex;
      align-items:center;
    }
    .home-notices-detail-body{
      flex:1;
      overflow-y:auto;
      padding-right:.25rem;
    }
    .home-notices-detail-title{
      font-size: 1.2rem;
      font-weight:800;
      margin-bottom:.25rem;
    }
    .home-notices-detail-date{
      color:var(--text-soft);
      font-size: .9rem;
      margin-bottom:.75rem;
    }
    .home-notices-detail-text{
      color:var(--text);
      line-height: 1.5;
      white-space:pre-line;
    }

    .tab-estudio-layout{
      display:grid;
      grid-template-columns: minmax(0,1.55fr) minmax(18.75rem,5.55fr);
      gap: 1rem;
      position: relative;
      z-index: 0;
    }
    .study-main-column{
      width: 20rem;
    }
    .study-main-column,
    .study-side-column{
      display:flex;
      flex-direction:column;
      gap:1rem;
      min-width:0;
    }
    .study-timer-card{
      display:flex;
      flex-direction:column;
      gap:.9rem;
      padding:1.25rem;
      border-radius: 1.125rem;
      background: color-mix(in srgb, var(--surface) 62%, var(--card) 38%);
      border:1px solid color-mix(in srgb, var(--border) 74%, transparent);
      box-shadow: 0 0.375rem 1.25rem rgba(15, 23, 42, 0.06);
      transition: box-shadow .25s ease, border-color .25s ease, background-color .25s ease;
    }
    .study-timer-card.running{
      box-shadow: 0 .55rem 1.35rem rgba(59, 130, 246, 0.16);
      border-color: color-mix(in srgb, var(--primary) 35%, var(--border));
    }
    .study-timer-status{
      display:inline-flex;
      width: fit-content;
      align-items:center;
      gap:.35rem;
      padding:.28rem .7rem;
      border-radius:999px;
      font-size:.85rem;
      font-weight:600;
      color:var(--text-soft);
      background:var(--surface);
      border:1px solid var(--border);
    }
    .study-timer-status::before{
      content:"•";
      font-size:1rem;
      line-height:1;
    }
    .study-timer-status[data-state="running"]{ color:var(--ui-success); border-color:var(--ui-success); }
    .study-timer-status[data-state="paused"]{ color:var(--ui-warn); border-color:var(--ui-warn); }
    .study-timer-status[data-state="finished"]{ color:var(--info); border-color:var(--info-40); }
    .timer-header-dashboard{
      flex-direction:column;
      align-items:center;
      gap:1rem;
    }
    .timer-display-dashboard{
      font-size: clamp(2.45rem, 6vw, 3.45rem);
      font-family: inherit;
      font-weight: 700;
      font-variant-numeric: tabular-nums;
      letter-spacing: .16rem;
      color: var(--primary);
      text-align:center;
      line-height: 1;
      transition: color .25s ease, text-shadow .25s ease, transform .25s ease;
      animation: timer-display-pop .3s ease;
    }
    .timer-display-dashboard.running{
      text-shadow: 0 0 1.125rem color-mix(in srgb, var(--primary) 25%, transparent);
      transform: translateY(-1px);
    }
    .timer-display-dashboard.paused{
      color: var(--text-soft);
      text-shadow: none;
    }
    .timer-controls-dashboard{
      justify-content:center;
      width:100%;
      gap:.75rem;
    }
    .timer-controls-dashboard .icon-btn{
      width:2.75rem;
      height:2.75rem;
      border-radius:50%;
      border:1px solid color-mix(in srgb, var(--border) 76%, transparent);
      background: var(--surface);
      box-shadow: 0 .25rem .75rem rgba(15,23,42,.08);
      transition: transform .2s ease, box-shadow .2s ease, background-color .2s ease, color .2s ease, border-color .2s ease;
    }
    .timer-controls-dashboard .icon-btn:hover{
      transform: translateY(-2px);
      box-shadow: 0 .5rem .95rem rgba(15,23,42,.15);
      background: color-mix(in srgb, var(--surface) 55%, var(--card));
    }
    #studyTimerStart{
      background: var(--primary);
      color: #fff;
      border-color: color-mix(in srgb, var(--primary) 65%, transparent);
      box-shadow: 0 .35rem .85rem color-mix(in srgb, var(--primary) 32%, transparent);
    }
    #studyTimerStart:hover{
      background: color-mix(in srgb, var(--primary) 88%, #fff);
      color:#fff;
    }
    @keyframes timer-display-pop{
      from{ opacity:.85; transform: scale(.985); }
      to{ opacity:1; transform: scale(1); }
    }
    .timer-actions-dashboard{
      justify-content:center;
    }
    .study-calendar-compact #calendarGrid{ margin-top: .5rem; }

    .study-stats-grid{
      display:grid;
      grid-template-columns:repeat(3,minmax(0,1fr));
      gap:.85rem;
    }
    .study-stat-card{
      background:var(--card);
      border:1px solid var(--border);
      border-radius:var(--radius);
      padding:.85rem .9rem;
      display:flex;
      flex-direction:column;
      gap:.35rem;
      justify-content: space-between;
      flex-direction: column;
      align-items: center;
    }

    .study-stat-label{ color:var(--text-soft); font-size:.84rem; font-weight:600; }
    .study-stat-value{ color:var(--text); font-size:1.15rem; font-weight:700; }

    @media(max-width:900px){
      .tab-estudio-layout{ grid-template-columns:1fr; }
      .study-stats-grid{ grid-template-columns:1fr; }
    }

    .calendar-container{
      background:var(--card);
      border-radius: var(--radius);
      padding: 1rem;
      border:1px solid var(--border);
      box-shadow:none;
      position: relative;
      z-index: 2;
    }
    .calendar-header{
      display:flex;
      justify-content:space-between;
      align-items:center;
      margin-bottom:1rem;
      gap: .6rem;
      flex-wrap:wrap;
    }
    .cal-left{
      display:flex; align-items:center; gap:.5rem; flex-wrap:wrap;
    }
    .cal-right{
      display:flex; align-items:center; gap:.5rem; flex-wrap:wrap; justify-content:flex-end;
    }
    #monthTitle, #acadMonthTitle{ font-size:1.25rem; font-weight:700; letter-spacing:.12px; line-height:1.2; }
    .cal-nav-btn{
      padding: .4rem .75rem;
      border-radius: 62.438rem;
      background:transparent;
      color:var(--text);
      border:1px solid transparent;
      font-size: .86rem;
      box-shadow:none;
    }
    .cal-nav-btn:hover{ background:var(--primary-soft); color:var(--primary); }

    .grid{ display:grid; 
      grid-template-columns:repeat(7,minmax(0,1fr)); gap:10px;
      width: 100%;
      min-width: 0;
      position: relative;
      z-index: 2;
      pointer-events: auto;
    }
    .grid > *{ min-width:0; }
    .dow{
      font-size: .78rem;
      color:var(--color-muted);
      line-height:1.2;
      letter-spacing:.015em;
      text-align:center;
      padding: .25rem 0;
    }

    /* ===== ESTUDIO (fijo y simple) ===== */
    .day{
      min-height: 6.875rem;
      background:var(--card);
      border-radius: var(--radius-sm);
      padding: 0.625rem;
      cursor:pointer;
      font-size: .9rem;
      position:relative;
      border:1px solid var(--border);
      min-width: 0;
      max-width: 100%;
      overflow:hidden;
      z-index: 3;
      pointer-events: auto;
    }
    #calendarGrid .day > *{ pointer-events:none; }

    .study-detail-panel{
      position: relative;
      z-index: 1;
      background:var(--card);
      border:1px solid var(--border);
      border-radius:var(--radius);
      padding:1rem;
      display:flex;
      flex-direction:column;
      gap:.75rem;
    }
    .day:hover{ border-color:var(--info-45); }
    .day-number{
      display:flex;
      align-items:center;
      justify-content:space-between;
      color:var(--text);
      font-weight:600;
      letter-spacing:.01em;
      line-height:1.2;
      gap: .45rem;
      min-width: 0;
    }
    .day-number span{ min-width:0; }
    .today-dot{
      width: 0.5rem; height:0.5rem; border-radius:50%;
      background:var(--color-accent-2);
      opacity:0;
      transition:opacity .2s ease;
    }
    .day.is-today .today-dot{ opacity:1; }
    .day-muted{
      background:var(--border-50);
      border:1px dashed var(--border);
      cursor:default;
    }
body.light-mode .calendar-container,
body[data-theme="light"] .calendar-container{
  background:var(--card);
  border-color: var(--border);
  box-shadow:none;
}
body.light-mode .day,
body[data-theme="light"] .day{
  background:var(--card);
  border-color: var(--border);
}
body.light-mode .day-muted,
body[data-theme="light"] .day-muted{
  background:var(--border-50);
}
body.light-mode .event,
body[data-theme="light"] .event{
  background:var(--primary-soft);
  border-color: var(--info-35);
  color:var(--text);
  box-shadow:none;
}

    /* ESTADÍSTICAS */
    .stats-card{
      background:var(--card);
      border-radius: var(--radius);
      padding: .9rem;
      border:1px solid var(--border);
      box-shadow:none;
    }
    .stats-title{ font-weight:600; letter-spacing:.01em; margin-bottom:.4rem; }
    .stats-item{ color:var(--text); margin-bottom:.3rem; }

    /* MODAL ESTUDIO */
    .modal-bg{
      position:fixed;
      inset:0;
      background:rgba(15,23,42,.35);
      backdrop-filter: blur(3px);
      display:none;
      align-items:center;
      justify-content:center;
      z-index:1200;
      padding: 1.5rem;
    }
    .modal{
      background: var(--color-surface-3);
      border-radius: 1.125rem;
      padding: 1.25rem 1.35rem;
      min-width: 20rem;
      max-width: 40rem;
      width: 100%;
      border:1px solid var(--border-70);
      box-shadow:0 18px 45px rgba(15,23,42,.12);
      display:flex;
      flex-direction:column;
      gap: 1rem;
    }
    .modal h3{ margin:0; font-weight:700; line-height:1.25; letter-spacing:-0.01em; }
    .modal-header{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: .75rem;
    }
    .modal-close{
      border:none;
      background:var(--color-surface-3);
      color:var(--text);
      width: 2.25rem;
      height: 2.25rem;
      border-radius: 50%;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      cursor:pointer;
      font-size: 1.1rem;
    }
    .modal-body{
      display:flex;
      flex-direction:column;
      gap: .85rem;
    }
    .modal-field label{
      display:block;
      font-size: .85rem;
      color:var(--muted);
      font-weight:500;
      line-height:1.3;
      letter-spacing:.02em;
      margin-bottom:.35rem;
    }
    .modal input, .modal textarea, .modal select{
      width: 100%;
      padding: .7rem .85rem;
      border-radius: 0.75rem;
      border:1px solid var(--input-border);
      background:var(--input-bg);
      color:var(--color-text);
      box-shadow:none;
      font-size: .95rem;
      box-sizing:border-box;
    }
    .modal textarea{ min-height:90px; resize:vertical; }
    .modal select,
    .subject-form-box select,
    .prof-filters select,
    #tab-perfil.profile-page .profile-field select{
      appearance:none;
      -webkit-appearance:none;
      -moz-appearance:none;
      background-image:
        linear-gradient(45deg, transparent 50%, currentColor 50%),
        linear-gradient(135deg, currentColor 50%, transparent 50%);
      background-position:
        calc(100% - 16px) calc(50% - 2px),
        calc(100% - 10px) calc(50% - 2px);
      background-size:6px 6px, 6px 6px;
      background-repeat:no-repeat;
      padding-right:2.1rem;
      caret-color:var(--color-text);
      color:var(--color-text);
    }
    .modal select option,
    .subject-form-box select option,
    .prof-filters select option,
    #tab-perfil.profile-page .profile-field select option{
      background:var(--card-bg);
      color:var(--color-text);
    }
    .modal select option:checked,
    .subject-form-box select option:checked,
    .prof-filters select option:checked,
    #tab-perfil.profile-page .profile-field select option:checked{
      background:var(--card-bg);
      color:var(--color-text);
    }
    /* Select option */
    #subjectNameSelect optgroup {
  background-color: var(--card-bg);
  color: var(--text-primary);
  }
  #studyTimerMateria option{
    background-color: var(--card-bg);
    color: var(--text-primary);
  }

   /* Select option */
    .modal select:disabled,
    .subject-form-box select:disabled,
    .prof-filters select:disabled,
    #tab-perfil.profile-page .profile-field select:disabled{
      opacity:.6;
      cursor:not-allowed;
    }
    .modal-inline-row{
      display:grid;
      grid-template-columns:repeat(2, minmax(0,1fr));
      gap: .75rem;
    }
    .modal-section-title{
      font-weight:700;
      margin-bottom:.35rem;
      color:var(--text);
      font-size: .9rem;
    }
    .modal-footer{
      position:sticky;
      bottom: 0;
      display:flex;
      justify-content:flex-end;
      gap: .6rem;
      flex-wrap:wrap;
      padding-top:.5rem;
      background:inherit;
    }
    .btn-large{
      padding: .7rem 1.25rem;
      font-size: .95rem;
      border-radius: 0.75rem;
    }
    .pill-group{
      display:flex;
      flex-wrap:wrap;
      gap: .5rem;
    }
    .pill-btn{
      border:1px solid var(--border-60);
      background:var(--input-bg);
      color:var(--muted);
      padding: .35rem .9rem;
      border-radius: 62.438rem;
      font-size: .85rem;
      cursor:pointer;
      transition:all .15s ease;
    }
    .pill-btn.is-active{
      background:var(--primary-soft);
      border-color:var(--info-45);
      color:var(--primary);
      font-weight:600;
    }
    .sr-only{
      position:absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow:hidden;
      clip:rect(0,0,0,0);
      white-space:nowrap;
      border:0;
    }
    .pwd-wrap{ position:relative; }
    .pwd-toggle{
      position:absolute;
      right: 0.625rem; top:50%;
      transform:translateY(-50%);
      padding: .3rem .45rem;
      font-size: .85rem;
      border-radius: var(--radius-sm);
    }
    .modal-help{
      max-width: 45rem;
      background:var(--surface-98);
      border:1px solid var(--accent-38);
      box-shadow:none;
    }
    .help-modal-body{
      background:var(--color-surface-3);
      border:1px solid var(--border-50);
      border-radius: var(--radius-md);
      padding: .75rem .85rem;
      line-height: 1.45;
      color:var(--color-text);
      box-shadow:none;
    }
    .help-section-title{
      font-weight:800;
      margin-bottom:.35rem;
      color:var(--color-text);
    }
    .help-list{
      margin: 0;
      padding-left:1.1rem;
      color:var(--text-soft);
    }
    .help-list li{ margin-bottom:.25rem; }
    .help-modal-actions{
      display:flex;
      justify-content:flex-end;
      gap: .5rem;
      margin-top:.8rem;
    }

    /* TAB ACADEMICO */
    .acad-layout{
      display:grid;
      grid-template-columns:minmax(0,70%) minmax(280px,30%);
      gap: 1.5rem;
    }
    @media(max-width:980px){ .acad-layout{ grid-template-columns:1fr; } .acad-widgets{ position:static; } }
    .acad-shell,
    .acad-detail,
    .acad-widgets,
    .planner-box{
      background:var(--card);
      border-radius: var(--radius);
      border:1px solid var(--border);
      padding: 1rem;
      box-shadow:none;
      margin-bottom: 12px;
    }
    .acad-widgets{
      padding: 1rem;
    }
    .acad-help{
      font-size: .9rem;
      color:var(--muted);
      line-height: 1.35;
      margin-bottom:.55rem;
    }
    .acad-widgets{
      width: auto;
      position:sticky;
      top:1rem;
      align-self:start;
    }
    .acad-shell .day{
      min-height: 6.875rem;
      display:flex;
      flex-direction:column;
      min-width: 0;
      max-width: 100%;
      overflow:hidden;
    }
    .acad-day-list{
      display:flex;
      flex-direction:column;
      gap: .4rem;
      margin-top:.4rem;
      flex:1;
      overflow-y:auto;
      overflow-x:hidden;
      padding-right:.15rem;
      max-width: 100%;
      min-width: 0;
    }
    .acad-day-item{
      display:grid;
      grid-template-columns:auto 1fr auto;
      gap: .6rem;
      align-items:center;
      padding: .55rem .65rem;
      border-radius: var(--radius-md);
      background:var(--color-surface-3);
      border:1px solid var(--border-85);
      box-shadow:none;
      cursor:pointer;
      min-width: 0;
      max-width: 100%;
      overflow:hidden;
    }
    .acad-day-item:hover{ border-color:var(--accent-50); }
    .acad-item-left{
      display:flex;
      align-items:center;
      gap: .35rem;
      flex-wrap:wrap;
      min-width: 0;
      max-width: 100%;
      overflow:hidden;
    }
    .acad-item-title{
      font-weight:700;
      font-size: .95rem;
      max-width: 100%;
      overflow:hidden;
      text-overflow:ellipsis;
      white-space:nowrap;
    }
    .acad-item-meta{
      color:var(--muted);
      font-size: .82rem;
      max-width: 100%;
      overflow:hidden;
      text-overflow:ellipsis;
      white-space:nowrap;
    }
    .acad-item-right{
      font-size: .85rem;
      color:var(--muted);
    }
    .acad-detail-top{
      display:flex;
      justify-content:space-between;
      gap: .6rem;
      align-items:flex-start;
      flex-wrap:wrap;
      margin-bottom:.4rem;
    }
    .acad-detail-title{
      font-weight:800;
      letter-spacing: .1px;
    }
    .acad-detail-sub{
      color:var(--muted);
      font-size: .86rem;
    }
    .acad-detail-list{
      display:flex;
      flex-direction:column;
      gap: .45rem;
    }
    .acad-detail-row{
      display:flex;
      justify-content:space-between;
      gap: .55rem;
      align-items:flex-start;
      padding: .7rem .8rem;
      border-radius: var(--radius-sm);
      background:var(--card);
      border:1px solid var(--border);
      box-shadow:none;
    }
    .acad-detail-text{
      min-width: 0;
    }
    .acad-detail-text strong{
      display:block;
      font-size: .9rem;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .acad-detail-meta{
      font-size: .82rem;
      color:var(--muted);
      margin-top:.15rem;
      line-height: 1.25;
      max-width: 100%;
      overflow:hidden;
      text-overflow:ellipsis;
      white-space:nowrap;
    }
    .acad-detail-notes{
      margin-top:.35rem;
      font-size: .84rem;
      color:var(--muted);
      line-height: 1.25;
      max-width: 100%;
      overflow:hidden;
      display:-webkit-box;
      -webkit-line-clamp:2;
      -webkit-box-orient:vertical;
      white-space:pre-wrap;
    }

    .activity-item{
      display:flex;
      align-items:flex-start;
      gap:.6rem;
    }
    .activity-check {
      width: 18px;
      height: 18px;
      border-radius: 50%;
      border: 2px solid var(--border-soft);
      background: transparent;
      cursor: pointer;
      transition: all 0.2s ease;
      flex: 0 0 18px;
      margin-top: .2rem;
    }
    .activity-check.completed {
      background: var(--primary);
      border-color: var(--primary);
    }
    .activity-item.completed {
      opacity: 0.6;
    }
    .activity-item.completed .activity-content {
      text-decoration: line-through;
    }
    .acad-detail-actions{
      display:flex;
      gap: .35rem;
      flex-wrap:wrap;
      justify-content:flex-end;
      flex:0 0 auto;
    }
    .acad-info-panel{
      display:flex;
      gap: .8rem;
      min-height: auto;
      flex-direction:column;
    }
    .acad-info-empty{
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      text-align:center;
      padding: 1.5rem 1rem;
      border-radius: var(--radius);
      background:var(--primary-soft);
      border:1px dashed var(--info-25);
      min-height: 11.25rem;
      max-height: 13.75rem;
      min-width: 100%;
      gap: .6rem;
    }
    .acad-empty-logo img{
      width: 6rem;
      height: auto;
      filter:none;
    }
    .acad-empty-title{
      font-weight:800;
      color:var(--text);
    }
    .acad-empty-sub{
      color:var(--muted);
      font-size: .9rem;
    }
    .acad-next-row{
      font-size: .88rem;
      color:var(--color-text);
      margin-bottom:.25rem;
    }
    .acad-detail-empty{
      color:var(--text-soft);
      font-size: .9rem;
      padding: .35rem 0;
    }
    .acad-day-modal-top{
      display:flex;
      justify-content:space-between;
      align-items:flex-start;
      gap: .75rem;
      margin-bottom:.75rem;
      flex-wrap:wrap;
    }
    .acad-day-modal-actions{
      display:flex;
      justify-content:flex-end;
      margin-top:.8rem;
    }
    .acad-record-detail{
      margin-top:.75rem;
      padding: .75rem;
      border-radius: var(--radius-md);
      background:var(--color-surface-3);
      border:1px solid var(--border-85);
      color:var(--color-text);
      font-size: .9rem;
      line-height: 1.35;
    }
    .day.is-selected{
      border-color:var(--info-45);
      background:var(--info-06);
    }
    .badge-soft{
      display:inline-flex;
      align-items:center;
      padding: .12rem .55rem;
      border-radius: var(--radius-pill);
      border:1px solid var(--border);
      background:var(--primary-soft);
      font-size: .75rem;
      color:var(--muted);
    }

    /* AGENDA SEMANAL */
    .agenda-header{
      display:flex;
      justify-content:space-between;
      align-items:center;
      margin-bottom:.6rem;
      gap: .6rem;
      flex-wrap:wrap;
    }
    .agenda-actions{
      display:flex;
      gap: .6rem;
      flex-wrap:wrap;
      align-items:center;
      justify-content:flex-end;
      width: 100%;
    }
    .agenda-downloads{
      display:flex;
      gap: .35rem;
      flex-wrap:wrap;
    }
    .agenda-shell{
      grid-column: 1 / -1;
      /* esto controla el fondo del calendario  background:var(--surface-94);*/
      border-radius: var(--radius-lg);
      /*border:1px solid var(--border-85); */
      padding: .5rem;
      overflow:visible !important;
      box-shadow:none;
      height:auto !important;
      max-height:none !important;
    }

    #tab-agenda{
      overflow:visible !important;
    }

    .main-shell{
      overflow:visible !important;
    }
    .agenda-grid{
      display:grid;
      grid-template-columns:70px repeat(6,1fr);
      font-size: .8rem;
      min-width: 41.25rem;
      position:relative;
    }
    .agenda-hour-spacer{
      height: var(--agenda-header-h);
      border-bottom: 1px solid var(--border-85);
    }
    .agenda-hour-col{ display:flex; flex-direction:column; }
    .agenda-hour{
      height: var(--agenda-hour-h);
      border-bottom: 1px dashed var(--border-85);
      padding-right: .3rem;
      text-align: right;
      color: var(--text-soft);
      display: flex;

      align-items: flex-start;
      justify-content: flex-end;
      padding-top: 6px;
      padding-bottom: 0;
    }
    .agenda-hour-end{
      height: 0;
      border-bottom: none;
      padding-top: 6px;
      padding-bottom: 0;
    }
    .agenda-day-col{ border-left:1px solid var(--border-85); position:relative; }
    .agenda-day-header{
      /*position: sticky; */
      top: 0;
      background: var(--surface-98);
      text-align: center;
      font-weight: 700;
      letter-spacing: 0.01em;
      border-bottom: 1px solid var(--border-85);
      z-index: 3;

      height: var(--agenda-header-h);
      padding: 0;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .agenda-day-inner{ position:relative; }
    .agenda-line{
      position:absolute;
      left: 0; right:0;
      height: 1px;
      background:var(--primary-22);
      opacity:.7;
    }
    .class-block{
      position:absolute;
      left: 0.25rem; right:0.25rem;
      border-radius: 0.5rem;
      padding: 0.375rem 0.5rem;
      /* color:var(--color-text); */
      color:black;

      
      font-size: .75rem;
      box-shadow:0 4px 10px color-mix(in srgb, var(--materia-color, var(--accent)) 16%, transparent);
      border:none;
      border-left:6px solid var(--materia-color, var(--accent));
      cursor:pointer;
      overflow:hidden;
      background-color:color-mix(in srgb, var(--materia-color, var(--accent)) 18%, white);
      font-weight:600;
    }
    .class-block strong{
      display:block;
      font-size: .8rem;
      line-height: 1.2;
      letter-spacing: .01em;
      color:var(--text);
    }
    .class-block small{
      display:block;
      font-size: .72rem;
      opacity:.9;
      color:color-mix(in srgb, var(--text) 82%, var(--muted));
    }

    /* TAB MATERIAS */
    .subjects-layout{
      display:grid;
      grid-template-columns:minmax(0,1.4fr) minmax(0,1fr);
      gap: 1rem;
    }
    @media(max-width:820px){ .subjects-layout{ grid-template-columns:1fr; } }
    .subjects-list-box, .subject-form-box{
      background:var(--surface-94);
      border-radius: var(--radius-md);
      border:1px solid var(--border-85);
      padding: 1rem;
      box-shadow:none;
      position:relative;
      overflow:hidden;
    }
    .subjects-list-box::before, .subject-form-box::before{
      content:"";
      position:absolute;
      inset:0 0 auto 0;
      height: 0.25rem;
      background:var(--accent-605);
      opacity:.6;
      pointer-events:none;
    }
    .subjects-list-header, .subject-form-header{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap: .6rem;
      margin-bottom:.75rem;
    }
    .subjects-list{
      display:flex;
      flex-direction:column;
      gap: .5rem;
      margin-top:.2rem;
    }
    .subjects-empty-msg{
      font-size: .85rem;
      color:var(--color-muted-2);
      background:var(--color-surface-3);
      border-radius: var(--radius-sm);
      border:1px dashed var(--border-85);
      padding: .65rem .7rem;
      margin-top:.6rem;
    }
    .subject-row{
      display:flex;
      align-items:center;
      gap: .6rem;
      background:var(--color-surface-3);
      border-radius: var(--radius-md);
      border:1px solid var(--border-85);
      padding: .6rem .75rem;
      box-shadow:none;
      transition:transform .15s ease, border-color .15s ease;
    }
    .subject-row:hover{
      transform:translateY(-1px);
      border-color:var(--accent-50);
      box-shadow:none;
    }
    .subject-color-dot{
      width: 1.125rem; height:1.125rem; border-radius:50%;
      border:1px solid var(--primary-90);
    }
    .subject-name{ flex:1; font-size:.92rem; font-weight:600; }
    .subject-actions{ display:flex; gap:.35rem; }
    .subject-form-field{
      display:flex;
      flex-direction:column;
      gap: .35rem;
      margin-bottom:.7rem;
    }
    #tab-planestudios{
      height: 150rem;
      overflow: hidden;
    }
    .plan-frame{
      width: 100%;
     height: 100%;
      border: 0;

    }
    .subject-form-field label{
      font-size: .82rem;
      color:var(--color-muted-2);
      font-weight:600;
    }
    .subject-form-box select,
    .subject-form-box input[type="text"]{
      padding: .75rem 1rem;
      border-radius: 62.438rem;
      border:1px solid var(--input-border);
      background:var(--input-bg);
      color:var(--color-text);
      font-size: .95rem;
      transition:border-color .2s ease, transform .2s ease;
    }
    .subject-form-box select:focus,
    .subject-form-box input[type="text"]:focus{
      border-color:var(--accent-80);
      outline:2px solid var(--accent-20);
      outline-offset:1px;
      box-shadow:none;
      transform:translateY(-1px);
    }
    .subject-color-row{
      display:flex;
      flex-direction:column;
      align-items:flex-start;
      gap: .55rem;
      position:relative;
      background:var(--color-surface-3);
      border:1px solid var(--border-85);
      border-radius: var(--radius-md);
      padding: .7rem .8rem;
      box-shadow:none;
    }
    .subject-color-palette{
      display:flex;
      gap: .5rem;
      flex-wrap:wrap;
    }
    .subject-color-swatch{
      width: 2.125rem;
      height: 2.125rem;
      border-radius: 50%;
      border:2px solid transparent;
      background:var(--color-surface-3);
      cursor:pointer;
      box-shadow:none;
      transition:transform .15s ease, border-color .15s ease;
    }
    .subject-color-swatch[data-color]{
      background:var(--swatch-color, transparent);
    }
    .subject-color-swatch:hover{
      transform:translateY(-1px) scale(1.03);
      box-shadow:none;
      border-color:var(--accent-45);
    }
    .subject-color-swatch.is-selected{
      border-color:var(--accent-90);
      outline:2px solid var(--accent-25);
      outline-offset:2px;
      box-shadow:none;
    }
    .subject-color-swatch--custom{
      background:var(--accent-1);
      display:flex;
      align-items:center;
      justify-content:center;
      position:relative;
    }
    .subject-color-swatch__custom{
      width: 60%;
      height: 60%;
      border-radius: 50%;
      border:2px solid var(--inverse-90);
      box-shadow:none;
      background:var(--surface-3);
    }
    .subject-color-input{
      position:absolute;
      opacity:0;
      pointer-events:none;
      width: 1px;
      height: 1px;
    }
    .subject-color-manual{
      display:flex;
  
      gap: .35rem;
      margin-top:.2rem;
    }
    .subject-color-text{
      border-radius: 62.438rem;
    }
    .subject-color-text.is-invalid{
      border-color:var(--danger-70);
      outline:2px solid var(--danger-18);
      outline-offset:1px;
      box-shadow:none;
    }
    .subject-color-text.is-valid{
      border-color:var(--ok-60);
      outline:2px solid var(--ok-18);
      outline-offset:1px;
      box-shadow:none;
    }
    .subject-color-hint{
      font-size: .78rem;
      color:var(--color-muted-2);
    }
    .subject-form-actions{
      margin-top:.2rem;
      display:flex;
      gap: .5rem;
      justify-content:flex-end;
    }
    .subject-form-note{
      margin-top:.75rem;
      font-size: .8rem;
      color:var(--color-muted-2);
      background:var(--accent-08);
      border-radius: var(--radius-sm);
      padding: .55rem .65rem;
      border:1px solid var(--accent-20);
    }

    /* TAB PERFIL */
    .profile-layout{
      display:grid;
      grid-template-columns:minmax(0,1.2fr) minmax(0,1fr);
      gap: 1rem;
    }
    @media(max-width:980px){ .profile-layout{ grid-template-columns:1fr; } }
    .profile-card{
      background:var(--surface-94);
      border-radius: var(--radius-lg);
      border:1px solid var(--border-85);
      padding: 1rem;
      box-shadow:none;
    }
    .profile-header{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap: .6rem;
      margin-bottom:.8rem;
    }
    .profile-email{
      font-size: .85rem;
      color:var(--color-muted-2);
      padding: .35rem .6rem;
      border-radius: var(--radius-sm);
      background:var(--color-surface-3);
      border:1px solid var(--border-85);
    }
    .profile-avatar{
      display:flex;
      align-items:center;
      gap: 1rem;
      flex-wrap:wrap;
      margin-bottom:1rem;
    }
    .profile-avatar img{
      width: 18.125rem;
      height: 18.125rem;
      border-radius: 50%;
      object-fit:cover;
      border:2px solid var(--border-60);
      background:var(--color-surface-3);
    }
    .profile-avatar-actions{
      display:flex;
      flex-direction:column;
      gap: .5rem;
      flex:1;
      min-width: 13.75rem;
    }
    .profile-avatar-input{
      display:inline-flex;
      align-items:center;
      gap: .4rem;
      padding: .45rem .75rem;
      border-radius: var(--radius-sm);
      border:1px dashed var(--border-60);
      background:var(--color-surface-3);
      color:var(--color-muted-2);
      font-size: .85rem;
      cursor:pointer;
      width: fit-content;
    }
    .profile-avatar-input input{
      display:none;
    }
    .profile-avatar-buttons{
      display:flex;
      gap: .5rem;
      flex-wrap:wrap;
    }
    .profile-avatar-status{
      font-size: .82rem;
      color:var(--color-muted-2);
    }
    .profile-grid{
      display:grid;
      grid-template-columns:repeat(2, minmax(0,1fr));
      gap: .75rem;
    }
    @media(max-width:720px){ .profile-grid{ grid-template-columns:1fr; } }
    .profile-field{
      display:flex;
      flex-direction:column;
      gap: .35rem;
    }
    .profile-field-wide{ grid-column:1 / -1; }
    .profile-field label{
      font-size: .82rem;
      color:var(--color-muted-2);
      font-weight:600;
    }
    .profile-actions{
      margin-top:.9rem;
      display:flex;
      align-items:center;
      gap: .75rem;
      flex-wrap:wrap;
    }
    .profile-status{
      font-size: .85rem;
      color:var(--color-muted-2);
    }
    .profile-security{
      display:flex;
      flex-direction:column;
      gap: .6rem;
    }

    /* TAB PLANIFICADOR */
    .planner-layout{
      display:grid;
      grid-template-columns:minmax(280px, 380px) minmax(0, 1fr);
      gap: 1rem;
      margin-bottom:12px;
    }
    @media(max-width:980px){ .planner-layout{ grid-template-columns:1fr; } }
    .planner-panel-left,
    .planner-panel-right{
      min-height: 0;
    }
    .planner-bottom-section{
      grid-column:1 / -1;
      margin-top: 1.5rem;
    }
    .planner-head-row{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap: .55rem;
      flex-wrap:wrap;
    }
    .planner-toolbar{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap: .6rem;
      flex-wrap:wrap;
    }
    .planner-toolbar-left{
      display:flex;
      align-items:center;
      gap: .5rem;
    }
    .planner-toolbar-right{
      display:flex;
      align-items:center;
      gap: .5rem;
      flex-wrap:wrap;
    }
    .planner-list{
      display:flex;
      flex-direction:column;
      gap:.7rem;
      margin-top:.65rem;
      max-height:calc(85vh - 23rem);
      min-height:12rem;
      overflow:auto;
      padding-right:.2rem;
    }
    .planner-filters{
      margin-top:.65rem;
      margin-bottom:.55rem;
      display:grid;
      grid-template-columns:minmax(260px, 1fr);
      gap: .5rem;
      align-items:center;
      justify-items:start;
    }
    @media (max-width:880px){
      .planner-filters{
        grid-template-columns:1fr;
      }
    }
    .preset-actions-row .btn-small{
      flex:1 1 auto;
      min-width: 6.25rem;
    }
    .hidden{
      display:none; 
    }
    .section-card{
      background:#ffffff;
      border-radius:14px;
      border:1px solid #d9e2ec;
      box-shadow:0 5px 14px rgba(15,23,42,.07);
      padding:.75rem .9rem;
    }
    .section-card-layout{
      display:grid;
      grid-template-columns:minmax(0, 1fr) auto;
      gap:1rem;
      align-items:center;
    }
    .section-academic-info{ min-width:0; }
    .section-title{
      font-weight:900;
      font-size:1.08rem;
      letter-spacing:.01em;
      text-transform:uppercase;
      color:#15253d;
    }
    .section-sub{
      color:#2c3e57;
      font-size:.9rem;
      margin-top:.2rem;
    }
    .section-schedule-wrap{
      margin-top:.5rem;
      overflow-x:auto;
    }
    .section-schedule-table{
      width:100%;
      border-collapse:collapse;
      font-size:.88rem;
      color:#1f3047;
    }
    .section-schedule-table th,
    .section-schedule-table td{
      padding:.38rem .55rem;
      border-bottom:1px solid #e5eaf1;
      border-right:1px solid #edf1f6;
      text-align:left;
      white-space:nowrap;
    }
    .section-schedule-table th:last-child,
    .section-schedule-table td:last-child{ border-right:none; }
    .section-schedule-table thead th{
      font-weight:800;
      color:#16283d;
      background:#f8fafc;
    }
    .section-schedule-table tbody tr:last-child td{ border-bottom:none; }
    .section-schedule-empty{
      color:#617084;
      font-style:italic;
    }
    .section-actions{
      display:flex;
      gap:.4rem;
      justify-content:flex-end;
      align-items:center;
    }
    .section-days{
      display:flex;
      gap: .35rem;
      flex-wrap:wrap;
    }
    .pill{
      display:inline-flex;
      align-items:center;
      padding: .2rem .55rem;
      border-radius: var(--radius-pill);
      background:var(--glass-soft);
      color:var(--color-text);
      font-size: .8rem;
      border:1px solid var(--border-18);
    }
    .pill-muted{
      color:var(--text-soft);
      border-color:var(--border-10);
      background:var(--primary-22);
    }
    .preset-item{
      display:flex;
      justify-content:space-between;
      align-items:flex-start;
      gap: .5rem;
      padding: .55rem .6rem;
      border-radius: var(--radius-md);
      background:var(--color-surface-3);
      border:1px solid var(--border-85);
      margin-bottom:.4rem;
      box-shadow:none;
    }
    .preset-item.active{
      border-color:var(--accent-60);
      box-shadow:none;
    }
    .preset-name{
      font-weight:800;
    }
    .preset-meta{
      color:var(--text-soft);
      font-size: .82rem;
      margin-top:.1rem;
    }
    .preset-row{
      display:flex;
      gap: .4rem;
      flex-wrap:wrap;
    }
    .input-mini{
      padding: .48rem .65rem;
      border-radius: var(--radius-md);
      border:1px solid var(--border-85);
      background:var(--color-surface-1);
      color:var(--color-text);
      box-shadow:none;
      font-size: .9rem;
    }
    .input-mini:focus{
      outline:none;
      border-color:var(--accent-80);
      box-shadow:0 0 0 3px color-mix(in srgb, var(--accent-60) 30%, transparent);
    }
    .badge{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      padding: .25rem .6rem;
      border-radius: var(--radius-sm);
      background:var(--accent-15);
      border:1px solid var(--accent-40);
      color:var(--color-text);
      font-weight:800;
      font-size: .8rem;
    }

/* ===== PROFESORES ===== */
.prof-directory-header{
  display:flex;
  justify-content:space-between;
  align-items:flex-end;
  gap:1rem;
  flex-wrap:wrap;
}
.prof-directory-header h2{ margin:0; }
.prof-filters{ display:flex; gap:.6rem; flex-wrap:wrap; }
.prof-search-input,
.prof-filters select{
  border:1px solid var(--input-border);
  border-radius:.75rem;
  background:var(--input-bg);
  color:var(--color-text);
  min-width:14rem;
}
.prof-search-input{
  display:flex;
  align-items:center;
  gap:.45rem;
  padding:0 .7rem;
}
.prof-search-input input{
  border:0;
  outline:none;
  background:transparent;
  color:inherit;
  width:100%;
  padding:.6rem 0;
}
.prof-filters select{ padding:.6rem .75rem; }

.prof-grid{
  display:grid;
  grid-template-columns:repeat(2, minmax(280px, 1fr));
  gap:.9rem;
  margin-top: 1rem;
}
.prof-card{
  display:grid;
  grid-template-columns:72px 1fr auto;
  gap:.8rem;
  border:1px solid var(--border-35);
  border-radius:var(--radius-lg);
  background:var(--surface-94);
  padding:.9rem;
  min-height:190px;
  height:100%;
  align-items:start;
}
.prof-photo{
  width:72px;
  height:72px;
  border-radius:1rem;
  object-fit:cover;
  background:var(--glass-faint);
}
.prof-card-content{ display:flex; flex-direction:column; gap:.3rem; min-width:0; }
.prof-card-name{ font-weight:800; font-size:1.05rem; line-height:1.25; }
.prof-card-rating{ font-weight:700; }
.prof-card-metrics{ color:var(--text-soft); font-size:.9rem; }
.prof-subjects{ display:flex; flex-wrap:wrap; gap:.35rem; margin-top:.2rem; }
.prof-subject-chip{
  background:var(--glass-faint);
  border:1px solid var(--border-22);
  border-radius:var(--radius-sm);
  padding:.15rem .45rem;
  font-size:.78rem;
}
.prof-card-action{ align-self:end; }

.prof-pagination{ display:flex; justify-content:center; align-items:center; gap:.8rem; }

.prof-detail-layout{ display:grid; grid-template-columns:minmax(290px, 380px) 1fr; gap:1rem; }
.prof-detail-main,
.prof-detail-reviews{
  border:1px solid var(--border-35);
  border-radius:var(--radius-lg);
  background:var(--surface-94);
  padding:1rem;
}
.prof-score-big{ font-size:2rem; font-weight:800; }
.prof-distribution-row{ display:grid; grid-template-columns:64px 1fr auto; gap:.5rem; align-items:center; margin-top:.4rem; }
.prof-distribution-bar{ height:8px; border-radius:99px; background:var(--glass-faint); overflow:hidden; }
.prof-distribution-bar > span{ display:block; height:100%; background:var(--color-accent); }
.prof-metric-list{ display:grid; gap:.45rem; margin-top:.8rem; }
.prof-metric-item{ display:flex; justify-content:space-between; gap:.5rem; font-size:.92rem; }
.prof-review-scroll{ max-height:540px; overflow:auto; padding-right:.25rem; }
.prof-review-item{ border:1px solid var(--border-16); border-radius:var(--radius-md); padding:.75rem; margin-top:.6rem; }
.prof-review-head{ display:flex; justify-content:space-between; gap:.5rem; }
.prof-review-criteria{ display:flex; flex-wrap:wrap; gap:.5rem 1rem; margin-top:.35rem; font-size:.85rem; color:var(--text-soft); }

.prof-modal{ position:fixed; inset:0; z-index:120; }
.prof-modal-backdrop{ position:absolute; inset:0; background:rgba(11,16,32,.56); }
.prof-modal-content{
  position:relative;
  max-width:620px;
  margin:4vh auto;
  max-height:92vh;
  overflow:auto;
  background:var(--surface-94);
  border:1px solid var(--border-35);
  border-radius:var(--radius-lg);
  padding:1rem;
  margin-top: 6rem;

}
.prof-modal-header{ display:flex; justify-content:space-between; align-items:center; gap:.5rem; }
.btn-icon{ border:0; background:transparent; color:var(--color-text); font-size:1rem; cursor:pointer; }
.prof-modal-professor{ font-weight:700; margin-bottom:.6rem; }
.prof-rating-group{ margin:.65rem 0; }
.prof-rating-group strong{ display:block; margin-bottom:.3rem; }
.star-picker{ display:flex; gap:.35rem; }
.star-btn{ border:0; background:transparent; color:var(--color-primary-soft); cursor:pointer; font-size:1.7rem; line-height:1; }
.star-btn.active{ color:var(--color-accent); }
.prof-modal-label{ display:block; margin-top:.55rem; }
.prof-modal-content textarea{
  width:100%;
  min-height:120px;
  border:1px solid var(--border-35);
  background:var(--input-bg);
  color:var(--color-text);
  border-radius:var(--radius-sm);
  padding:.65rem;
  resize:vertical;
}
.prof-rate-check{ display:flex; gap:.4rem; align-items:center; margin-top:.5rem; }
.prof-modal-actions{ display:flex; justify-content:flex-end; gap:.5rem; margin-top:.75rem; }

@media(max-width:920px){
  .prof-detail-layout{ grid-template-columns:1fr; }
}

.muted{ color:var(--text-soft); font-size:.9rem; }

/* ==== plan de estudio ==== */

/* ===== MENSAJES ===== */
.messenger-dock{
  position:fixed;
  right: 0.75rem;
  top: 6rem;
  bottom: 0.75rem;
  max-width: 30rem;
  width: min(30rem, 95vw);
  z-index:50;
}
.messenger-panel{
  height: 100%;
  background:var(--surface-94);
  border:1px solid var(--border-35);
  border-radius: var(--radius-2xl);
  box-shadow:none;
  padding: .85rem;
  display:flex;
  flex-direction:column;
  gap: .75rem;
  backdrop-filter: blur(10px);
  transition:transform .2s ease, opacity .2s ease;
}
.messenger-dock.collapsed .messenger-panel{
  transform:translateX(110%);
  opacity:.25;
  pointer-events:none;
}
.messenger-toggle{
  position:absolute;
  left: -3rem;
  top: 1rem;
  width: 2.625rem;
  height: 2.625rem;
  border-radius: var(--radius-md);
  border:1px solid var(--border-28);
  background:var(--accent-18);
  color:var(--color-text);
  cursor:pointer;
  box-shadow:var(--shadow-btn);
}
.messenger-head{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap: .6rem;
  flex-wrap:wrap;
}
.messenger-title{
  display:flex;
  gap: .6rem;
  align-items:center;
}
.messenger-actions{ display:flex; gap:.4rem; }
.messenger-icon{
  width: 2.625rem;
  height: 2.625rem;
  border-radius: 0.875rem;
  background:var(--accent-16);
  border:1px solid var(--accent-40);
  display:grid;
  place-items:center;
  font-size: 1.1rem;
}
.messenger-heading{ font-weight:800; font-size:1rem; }
.messenger-sub{ color:var(--color-muted); font-size:.88rem; }
.messenger-grid{
  display:grid;
  grid-template-columns: 1fr 1.15fr;
  gap: .75rem;
  height: 100%;
}
@media(max-width:1200px){
  .messenger-grid{ grid-template-columns:1fr; height:auto; }
}
.messenger-left, .messenger-right{
  display:flex;
  flex-direction:column;
  gap: .75rem;
}
.card-block, .chat-card{
  background:var(--surface-94);
  border:1px solid var(--border-30);
  border-radius: 0.875rem;
  padding: .85rem;
  box-shadow:none;
}
.block-title{
  font-weight:700;
  margin-bottom:.35rem;
  letter-spacing: .1px;
}
.friend-form{
  display:flex;
  gap: .5rem;
  margin-top:.35rem;
  flex-wrap:wrap;
}
.friend-form input{
  flex:1;
  min-width: 12.5rem;
  padding: .55rem .7rem;
  border-radius: 0.625rem;
  border:1px solid var(--border-50);
  background:var(--color-surface-3);
  color:var(--color-text);
}
.requests-box, .friends-box, .messages-box{
  display:flex;
  flex-direction:column;
  gap: .6rem;
}
.requests-group, .friends-group{ margin-top:.4rem; }
.friends-sections{
  display:flex;
  flex-direction:column;
  gap: .5rem;
}
.requests-group:not(:first-child){
  padding-top:.45rem;
  border-top:1px dashed var(--border-20);
}
.requests-header, .friends-header{
  font-size: .86rem;
  color:var(--text-soft);
  margin-bottom:.35rem;
  letter-spacing: .05rem;
}
.request-card{
  display:flex;
  justify-content:space-between;
  align-items:flex-start;
  border:1px solid var(--border-18);
  padding: .6rem .75rem;
  border-radius: 0.75rem;
  background:var(--glass-faint);
  gap: .4rem;
}
.req-email{ font-weight:700; }
.req-meta{ color:var(--text-soft); font-size:.85rem; }
.req-actions{ display:flex; gap:.45rem; }
.friends-box .muted, .requests-box .muted, .messages-box .muted{
  color:var(--text-soft);
  font-size: .9rem;
}
.friend-row{
  display:flex;
  justify-content:space-between;
  align-items:center;
  border:1px solid var(--border-18);
  padding: .55rem .7rem;
  border-radius: 0.75rem;
  background:var(--glass-faint);
  transition:border-color .12s ease;
}
.friend-main{
  display:flex;
  align-items:center;
  gap: .6rem;
}
.friend-avatar{
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 50%;
  object-fit:cover;
  border:1px solid var(--border-45);
  background:var(--color-surface-3);
}
.friend-row.friend-online{
  border-color:var(--ok-5);
  box-shadow:none;
}
.friend-name{ font-weight:700; }
.friend-meta{ color:var(--text-soft); font-size:.85rem; display:flex; gap:.45rem; align-items:center; }
.status-dot{
  width: 0.625rem;
  height: 0.625rem;
  border-radius: 62.438rem;
  background:var(--border-80);
  box-shadow:none;
}
.status-dot.online{
  background:var(--color-ok);
  box-shadow:none;
}
.chat-card{ flex:1; display:flex; flex-direction:column; gap:.65rem; }
.chat-header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap: .6rem;
  flex-wrap:wrap;
}
.chat-title{
  font-weight:800;
  font-size: 1.05rem;
}
.chat-subtitle{ color:var(--text-soft); font-size:.9rem; }
.toggle-line{
  display:inline-flex;
  align-items:center;
  gap: .4rem;
  color:var(--text-soft);
  font-size: .9rem;
}
/* CSS DEL TAMAÑO DE LA BANDEJA DE MSJ*/
.messages-box{
 /* min-height:260px;
  max-height: 26.25rem; */
  height: 60rem;
  overflow:auto;
  border:1px solid var(--border-30);
  border-radius: 0.875rem;
  padding: .75rem;
  background:var(--color-surface-3);
  box-shadow:none;
}
.msg-row{
  display:flex;
  margin-bottom:.5rem;
}
.msg-row.me{ justify-content:flex-end; }
.msg-bubble{
  max-width: 80%;
  padding: .55rem .65rem;
  border-radius: 0.875rem;
  background:var(--accent-18);
  border:1px solid var(--border-20);
  box-shadow:none;
}
.msg-row.other .msg-bubble{
  background:var(--border-12);
}
.msg-text{ white-space:pre-wrap; }
.msg-meta{ color:var(--text-soft); font-size:.78rem; margin-top:.25rem; }
.chat-input-row{
  display:flex;
  gap: .5rem;
  margin-top:auto;
}
.chat-input-row input{
  flex:1;
  padding: .65rem .75rem;
  border-radius: 0.75rem;
  border:1px solid var(--border-50);
  background:var(--color-surface-3);
  color:var(--color-text);
}
/* START Mensajería Styles */
.mensajeria-container{
  display:grid;
  grid-template-columns:minmax(280px, 360px) minmax(0, 1fr);
  gap: 1rem;
  align-items:start;
}

.sidebar-mensajes,
.panel-chat{
  display:flex;
  flex-direction:column;
  gap: .85rem;
}

.add-amigo-form input{
  min-width: 0;
}

.requests-block .block-title,
.friends-title-row{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap: .45rem;
  flex-wrap:wrap;
}

.friend-list{
  display:flex;
  flex-direction:column;
  gap: .55rem;
}

.friend-list-note{
  margin-bottom:.45rem;
}

.friend-item,
.friend-row{
  display:grid;
  grid-template-columns:minmax(0, 1fr) auto;
  gap: .6rem;
  align-items:center;
}

.friend-main{
  min-width: 0;
}

.friend-status{
  display:inline-flex;
  align-items:center;
  gap: .4rem;
}

.friend-status::before{
  content:"";
  width: 0.5rem;
  height: 0.5rem;
  border-radius: 50%;
  background:var(--border-80);
}

.friend-item.online .friend-status::before,
.friend-row.friend-online .friend-status::before{
  background:var(--color-ok);
}

.friend-actions,
.req-actions{
  display:flex;
  align-items:center;
  gap: .4rem;
}

.panel-chat .chat-card{
  min-height: 33.75rem;
}

.chat-placeholder{
  min-height: 13.75rem;
  display:grid;
  place-items:center;
  text-align:center;
  color:var(--text-soft);
  border:1px dashed var(--border-30);
  border-radius: 0.75rem;
  background:var(--surface-94);
  padding: 1rem;
}

@media (max-width: 1080px){
  .mensajeria-container{
    grid-template-columns:1fr;
  }

  .panel-chat .chat-card{
    min-height: 27.5rem;
  }
}
/* END Mensajería Styles */
/* =========================================================
   Mensajería encapsulada + botón de header
   ========================================================= */
.header-msg-btn{
  width: 2.625rem;
  height: 2.625rem;
  padding: 0;
  border-radius: 62.438rem;
  border:1px solid var(--border-85);
  background:var(--surface-94);
  color:var(--color-text);
  display:inline-flex;
  align-items:center;
  justify-content:center;
  cursor:pointer;
}
.header-msg-btn svg{
  width: 1.25rem;
  height: 1.25rem;
}
.header-msg-btn:hover{
  border-color:var(--accent-805);
}

#tab-mensajes{
  position:relative;
  z-index:2;
  min-height: calc(100vh - 14.375rem);
}

#tab-mensajes .mensajeria-layout{
  display:grid;
  grid-template-columns:minmax(300px, 380px) minmax(0, 1fr);
  gap: 1rem;
  align-items:stretch;
  min-height: calc(100vh - 16.25rem);
}

#tab-mensajes .mensajeria-sidebar,
#tab-mensajes .mensajeria-chat{
  min-width: 0;
  display:flex;
  flex-direction:column;
  gap: .85rem;
}

#tab-mensajes .mensajeria-card{
  overflow:hidden;
}

#tab-mensajes .mensajeria-chat-card{
  flex:1;
  min-height: 35rem;
  display:flex;
  flex-direction:column;
}

#tab-mensajes .messages-box{
  flex:1;
  min-height: 17.5rem;
  max-height: none;
  height: auto;
  overflow:auto;
}

#tab-mensajes .chat-input-row{
  margin-top:.65rem;
}

@media (max-width: 1080px){
  #tab-mensajes .mensajeria-layout{
    grid-template-columns:1fr;
    min-height: auto;
  }

  #tab-mensajes .mensajeria-chat-card{
    min-height: 28.75rem;
  }
}

/* =========================================================
   PERFIL · LAVADO VISUAL (aislado)
   Scope: #tab-perfil.profile-page
   ========================================================= */
#tab-perfil.profile-page{
  background:var(--card);
  border-radius: 1.5rem;
  padding: 1rem;
}

#tab-perfil.profile-page .profile-page-shell{
  width: min(100%, 61.25rem);
  margin: 0 auto;
  display:grid;
  gap: 1rem;
}

#tab-perfil.profile-page .profile-card{
  background:var(--card-bg);
  border:1px solid var(--card-border);
  border-radius: 1.375rem;
  box-shadow:var(--shadow-soft);
  padding: 1.25rem;
}

#tab-perfil.profile-page .profile-header{
  margin-bottom:.75rem;
}

#tab-perfil.profile-page .profile-header strong{
  font-size: 1.35rem;
  line-height: 1.2;
  color:var(--text-main);
}

#tab-perfil.profile-page .profile-header .small-muted,
#tab-perfil.profile-page .profile-status,
#tab-perfil.profile-page .profile-avatar-status{
  color:var(--text-soft);
  font-size: .92rem;
}

#tab-perfil.profile-page .profile-header-center{
  text-align:center;
}

#tab-perfil.profile-page .profile-avatar-centered{
  display:flex;
  flex-direction:column;
  align-items:center;
  text-align:center;
  gap: .7rem;
  margin-bottom:1.15rem;
}

#tab-perfil.profile-page .profile-avatar img{
  width: 8.25rem;
  height: 8.25rem;
  border-radius: 50%;
  object-fit:cover;
  border:4px solid var(--surface-98);
  box-shadow:var(--shadow-soft);
  background:var(--surface-6);
}

#tab-perfil.profile-page .profile-avatar .profile-header{
  position:relative;
  width:8.25rem;
  min-height:8.25rem;
  margin:0 auto;
}

#tab-perfil.profile-page #btnProfileLogout{
  position:absolute;
  top:50%;
  left:calc(100% + 2rem);
  transform:translateY(-50%);
  font-size:.78rem;
  line-height:1.2;
  padding:.4rem .7rem;
  min-height:auto;
  white-space:nowrap;
}

#tab-perfil.profile-page .profile-email{
  background:var(--accent-bg);
  border:1px solid var(--accent-30);
  color:var(--text-main);
  font-size: .86rem;
  border-radius: 62.438rem;
  padding: .4rem .9rem;
}

#tab-perfil.profile-page .profile-avatar-actions{
  width: 100%;
  display:flex;
  flex-direction:column;
  align-items:center;
  gap: .65rem;
}

#tab-perfil.profile-page .profile-avatar-input{
  width: min(100%, 20rem);
  justify-content:center;
  padding: .7rem 1rem;
  border:1px dashed var(--border-60);
  border-radius: 0.75rem;
  background:var(--input-bg);
  color:var(--text-main);
  font-weight:600;
}

#tab-perfil.profile-page .profile-avatar-buttons{
  width: min(100%, 20rem);
  display:grid;
  grid-template-columns:1fr 1fr;
  gap: .6rem;
}

#tab-perfil.profile-page .profile-section{
  margin-top:.25rem;
  border-top:1px solid var(--border-35);
  padding-top:1rem;
}

#tab-perfil.profile-page .profile-section-title{
  font-size: 1rem;
  font-weight:700;
  color:var(--text-main);
  margin-bottom:.85rem;
}

#tab-perfil.profile-page .profile-grid{
  display:grid;
  grid-template-columns:1fr;
  gap: .9rem;
}

#tab-perfil.profile-page .profile-field{
  gap: .45rem;
}

#tab-perfil.profile-page .profile-field label{
  color:var(--text-main);
  font-size: .9rem;
  font-weight:600;
}

#tab-perfil.profile-page .profile-field input,
#tab-perfil.profile-page .profile-field select{
  width: 100%;
  min-height: 3rem;
  border-radius: 0.75rem;
  border:1px solid var(--input-border);
  background:var(--input-bg);
  padding: .7rem .85rem;
  color:var(--color-text);
  font-size: 1rem;
  transition:border-color .2s ease, box-shadow .2s ease;
}

#tab-perfil.profile-page .profile-field input::placeholder{
  color:var(--text-soft);
}

#tab-perfil.profile-page .profile-field input:focus,
#tab-perfil.profile-page .profile-field select:focus{
  outline:none;
  border-color:var(--accent-border-strong);
  box-shadow:0 0 0 3px var(--accent-outline);
}

#tab-perfil.profile-page .profile-actions{
  margin-top:1.15rem;
  display:flex;
  flex-direction:column;
  gap: .65rem;
}

#tab-perfil.profile-page #btnProfileSave{
  width: 100%;
  min-height: 3.125rem;
  border-radius: 0.75rem;
  border:1px solid var(--btn-primary-border);
  background:var(--btn-primary-bg);
  color:var(--btn-primary-text);
  font-size: 1rem;
  font-weight:700;
  box-shadow:var(--shadow-btn);
}

#tab-perfil.profile-page #btnProfileSave:hover{
  background:var(--btn-primary-hover-bg);
}

#tab-perfil.profile-page .profile-security{
  gap: .8rem;
}

#tab-perfil.profile-page #btnPasswordReset,
#tab-perfil.profile-page #btnUploadAvatar,
#tab-perfil.profile-page #btnRemoveAvatar,
#tab-perfil.profile-page #btnProfileLogout{
  min-height: 2.75rem;
  border-radius: 0.625rem;
  font-weight:600;
  background:var(--btn-ghost-bg);
  border:1px solid var(--btn-ghost-border);
  color:var(--color-text);
}

#tab-perfil.profile-page #btnPasswordReset:hover,
#tab-perfil.profile-page #btnUploadAvatar:hover,
#tab-perfil.profile-page #btnRemoveAvatar:hover,
#tab-perfil.profile-page #btnProfileLogout:hover{
  background:var(--btn-soft-bg);
  border-color:var(--btn-soft-border);
}

#tab-perfil.profile-page #btnProfileLogout{
  background:#ff4d4d;
  border-color:#ff4d4d;
  color:#fff;
}

#tab-perfil.profile-page #btnProfileLogout:hover{
  background:#e60000;
  border-color:#e60000;
}

/* Desktop */
@media (min-width:768px){
  #tab-perfil.profile-page{
    padding: 1.4rem;
  }

  #tab-perfil.profile-page .profile-page-shell{
    gap: 1.25rem;
  }

  #tab-perfil.profile-page .profile-main-card,
  #tab-perfil.profile-page .profile-security-card{
    padding: 1.5rem;
  }

  #tab-perfil.profile-page .profile-grid{
    grid-template-columns:repeat(2, minmax(0,1fr));
  }

  #tab-perfil.profile-page .profile-field-wide{
    grid-column:1 / -1;
  }

  #tab-perfil.profile-page .profile-avatar-buttons,
  #tab-perfil.profile-page .profile-avatar-input{
    width: min(100%, 22.5rem);
  }

  #tab-perfil.profile-page .profile-actions{
    align-items:flex-start;
  }

  #tab-perfil.profile-page #btnProfileSave{
    width: auto;
    min-width: 15rem;
    padding-inline:1.8rem;
  }
}

/* =========================================================
   Header sticky + scroll top + icono mensajería
   ========================================================= */
html{
  font-size: 80%;
  scroll-behavior:smooth;
}

/* =========================================================
   Escala global compacta (equivalente visual a zoom 80% real)
   ========================================================= */
:root{
  --layout-compact-padding-x:1rem;
  --layout-compact-gap:1rem;
  --layout-compact-content-gap:.62rem;
  --layout-compact-card-padding:.9rem;
  --layout-compact-max-width:1400px;
}

header{
  padding: .82rem 1rem;
  gap: .62rem;
}

.page-layout{
  gap: var(--layout-compact-gap);
  width: calc(100% - (var(--layout-compact-padding-x) * 2));
  max-width: var(--layout-compact-max-width);
  margin: 0 auto;
  padding-top:.35rem;
}

.page-content{
  gap: var(--layout-compact-content-gap);
}

.main-shell{
  max-width: var(--layout-compact-max-width);
}

.tabs-bar{
  gap: .4rem;
  margin-bottom:.72rem;
}

.tab-card{
  padding: var(--layout-compact-card-padding);
}

@media(max-width:1024px){
  .page-layout{
    width: calc(100% - 1.2rem);
    padding: 0 .6rem;
    max-width: none;
  }
}

@media(max-width:768px){
  html{
    font-size: 88%;
  }

  header{
    padding: .78rem .82rem;
  }

  .tab-card{
    padding: .82rem;
  }
}

header{
  position:sticky;
  top: 0;
  z-index:1100;
  /*background:var(--header-bg); */
}

.page-layout{
  padding-top:.35rem;
}

.header-msg-btn{
  color:var(--color-text);
  opacity:1;
  border-color:var(--border-85);
  box-shadow:var(--shadow-btn);
  transition:transform var(--transition-fast), border-color var(--transition-fast), background-color var(--transition-fast), color var(--transition-fast), opacity var(--transition-fast);
}

.header-msg-btn:hover,
.header-msg-btn:focus-visible{
  color:var(--color-text);
  opacity:1;
  border-color:var(--accent-805);
  transform:translateY(-1px);
}

.header-msg-btn:active{
  transform:translateY(0) scale(.98);
}

.header-msg-btn svg{
  opacity:1;
  stroke:currentColor;
}

.scroll-top-btn{
  position:fixed;
  right: 1.25rem;
  bottom: 1.25rem;
  width: 2.875rem;
  height: 2.875rem;
  border-radius: 62.438rem;
  border:1px solid var(--border-85);
  background:var(--surface-94);
  color:var(--color-text);
  box-shadow:var(--shadow-btn);
  display:inline-flex;
  align-items:center;
  justify-content:center;
  font-size: 1.4rem;
  line-height: 1;
  z-index:1200;
  opacity:0;
  visibility:hidden;
  transform:translateY(8px);
  pointer-events:none;
  transition:opacity var(--transition-fast), transform var(--transition-fast), border-color var(--transition-fast), background-color var(--transition-fast);
}

.scroll-top-btn.is-visible{
  opacity:1;
  visibility:visible;
  transform:translateY(0);
  pointer-events:auto;
}

.scroll-top-btn:hover,
.scroll-top-btn:focus-visible{
  border-color:var(--accent-805);
  transform:translateY(-2px);
}

.scroll-top-btn:active{
  transform:translateY(0) scale(.98);
}

@media (max-width: 768px){
  .scroll-top-btn{
    right: 1rem;
    bottom: calc(1rem + env(safe-area-inset-bottom) + 3.75rem);
  }
}
.prof-list{
 display: grid;
  grid-template-columns: repeat(2, 1fr); /* 3 columnas */
  grid-template-rows: repeat(3, auto);   /* 2 filas */
  gap: 0.5rem; /* espacio entre botones */
}

.quick-sidebar .qs-footer{
  display: none;
}
/* Planner modal + chips sobre agenda */
.agenda-presets-bar{
  border:1px solid var(--border-85);
  background:var(--color-surface-3);
  border-radius:var(--radius-md);
  padding:.7rem;
  margin-bottom:.75rem;
}
.agenda-presets-head{ display:flex; justify-content:space-between; align-items:center; gap:.5rem; margin-bottom:.45rem; }
.agenda-presets-actions{ display:flex; align-items:center; gap:.5rem; flex-wrap:wrap; justify-content:flex-end; }
.preset-chips-row{ display:flex; flex-wrap:wrap; gap:.45rem; }
.preset-chip-wrap{ display:flex; align-items:center; gap:.2rem; }
.preset-chip{
  border:1px solid var(--border-60);
  background:var(--glass-soft);
  color:var(--color-text);
  border-radius:999px;
  padding:.36rem .72rem;
  font-weight:700;
  cursor:pointer;
}
.preset-chip.active{ background:var(--accent-15); border-color:var(--accent-60); }
.preset-chip.add{ width:2rem; padding:.36rem 0; text-align:center; }
.preset-chip-edit{ border:1px solid var(--border-60); background:transparent; color:var(--text-soft); border-radius:999px; padding:.2rem .45rem; }
.preset-delete-btn{
  background: transparent;
  border: none;
  cursor: pointer;
  color: var(--danger);
  transition: all 0.2s ease;
}
.preset-delete-btn:hover{
  transform: scale(1.1);
  opacity: 0.85;
}

.planner-modal-bg{ z-index:130; backdrop-filter:none; background:rgba(0, 0, 0, .5); animation: plannerFadeIn .2s ease; }
.planner-modal{
  position:relative;
  width:min(74vw, 1120px);
  max-width:1120px;
  max-height:85vh;
  height:auto;
  overflow:auto;
  background:#ffffff;
  border-radius:22px;
  border:1px solid #d5ddeb;
  box-shadow:0 18px 44px rgba(10,16,30,.2);
  padding:1rem 1rem .9rem;
  animation: plannerModalIn .24s ease;
  margin:auto;
}
body.light-mode .planner-modal,
body[data-theme="light"] .planner-modal{
  background:#ffffff;
  border-color:#d9e2ec;
}

.planner-modal-header{ display:flex; justify-content:space-between; gap:.75rem; align-items:flex-start; }
.planner-header{ display:flex; align-items:center; justify-content:space-between; gap:.8rem; flex:1; }
.planner-title{ min-width:0; }
.planner-search{ display:flex; justify-content:flex-end; }
.planner-search input{
  width:260px;
  padding:8px 12px;
  border-radius:999px;
  border:1px solid var(--border-soft, var(--border-85));
  background:var(--surface-soft, var(--surface-95));
  color:var(--color-text);
  font-size:14px;
  transition:all .2s ease;
}
.planner-search input:focus{
  outline:none;
  border-color:var(--primary, var(--accent-805));
  box-shadow:0 0 0 3px rgba(0, 0, 0, 0.05);
}
.planner-modal-title{ margin:0 0 .1rem; font-size:1.65rem; font-weight:900; color:var(--text-strong); }
.planner-modal-presets{ display:flex; align-items:center; gap:.55rem; margin:.55rem 0 .45rem; }
.planner-preset-actions{ margin-bottom:.4rem; }

.section-status{ margin-top:.3rem; font-size:.78rem; font-weight:700; }
.section-status.warn{ color:#b36d00; }
.section-card.blocked{ opacity:.86; }

.planner-preset-bubble{
  position:absolute;
  inset:0;
  margin:auto;
  width:min(92%, 360px);
  height:max-content;
  border:1px solid var(--border-70);
  background:var(--color-surface-2);
  border-radius:14px;
  box-shadow:var(--shadow-lg);
  padding:.8rem;
  display:none;
  z-index:3;
}
.planner-preset-bubble.is-open{ display:flex; flex-direction:column; gap:.55rem; }
.planner-preset-bubble label{ font-size:.84rem; font-weight:700; }
.planner-preset-bubble-actions{ display:flex; justify-content:flex-end; gap:.45rem; }

.planner-modal-footer{
  border-top:1px solid var(--border-85);
  margin-top:.75rem;
  padding-top:.65rem;
  display:flex;
  justify-content:space-between;
  gap:.75rem;
  align-items:center;
  flex-wrap:wrap;
}
.planner-summary{ color:var(--text-soft); font-size:.9rem; display:flex; gap:.5rem; align-items:center; flex-wrap:wrap; }
.planner-footer-actions{ display:flex; gap:.5rem; }


.subject-modal-form-box{
  margin-top:.85rem;
  border-radius:var(--radius-md);
  border:1px solid var(--border-85);
  background:var(--card-bg, var(--surface-94));
  padding:1rem;
}
.subject-modal-form-box .subject-color-row{
  background:var(--surface-95);
}


@media (max-width:780px){
  .planner-modal{ width:min(94vw,1120px); max-height:90vh; }
  .planner-modal-title{ font-size:1.45rem; }
  .planner-header{ flex-direction:column; align-items:flex-start; }
  .planner-search{ width:100%; }
  .planner-search input{ width:100%; }
  .planner-modal-presets{ flex-direction:column; align-items:flex-start; }
  .section-card-layout{ grid-template-columns:1fr; }
  .section-actions{ justify-content:flex-start; }
  .planner-list{ max-height:calc(90vh - 23rem); }
}


.btn-plan-add{
  border:1px solid color-mix(in srgb, var(--success, #146b60) 68%, var(--black) 12%);
  background:color-mix(in srgb, var(--success, #146b60) 86%, var(--surface-94) 14%);
  color:#ffffff;
  border-radius:12px;
  padding:.42rem .82rem;
  font-weight:800;
  display:inline-flex;
  align-items:center;
  gap:.28rem;
}
.btn-plan-add.btn-small{ font-size:.84rem; }
.btn-plan-add:hover{ background:color-mix(in srgb, var(--success, #146b60) 94%, #000 6%); }
.btn-plan-apply{
  border:1px solid color-mix(in srgb, var(--success, #146b60) 70%, var(--black) 12%);
  background:color-mix(in srgb, var(--success, #146b60) 88%, var(--surface-94) 12%);
  color:#ffffff;
  border-radius:14px;
  padding:.72rem 1.3rem;
  font-weight:900;
  letter-spacing:.01em;
  box-shadow:0 10px 20px color-mix(in srgb, var(--success, #146b60) 34%, transparent);
  transition:filter var(--transition-fast), transform var(--transition-fast), box-shadow var(--transition-fast);
}
.btn-plan-add:hover,
.btn-plan-add:focus-visible,
.btn-plan-apply:hover,
.btn-plan-apply:focus-visible{
  background:color-mix(in srgb, var(--success, #146b60) 76%, var(--black) 24%);
  color:#ffffff;
  transform:translateY(-1px);
}
.btn-plan-apply:active,
.btn-plan-add:active{ transform:translateY(0); }

@keyframes plannerModalIn{
  from{ opacity:0; transform:translateY(8px) scale(.985); }
  to{ opacity:1; transform:translateY(0) scale(1); }
}
@keyframes plannerFadeIn{
  from{ opacity:0; }
  to{ opacity:1; }
}


.acad-pending-list{ display:flex; flex-direction:column; gap:.6rem; }
.widget-title-row{ display:flex; justify-content:space-between; align-items:center; gap:.6rem; }
.acad-pending-item{ border-radius:var(--radius-md); border:1px solid var(--border-85); background:var(--card-bg, var(--card)); padding:.65rem .75rem; }
.acad-pending-item-title{ font-weight:700; color:var(--color-text); }
.acad-pending-item-meta,.acad-pending-item-time{ color:var(--text-soft); font-size:.82rem; }
.acad-pending-item.priority-alta{ border-color: color-mix(in srgb, #c44 35%, var(--border)); background: color-mix(in srgb, #c44 10%, var(--card-bg, var(--card))); }
.acad-pending-item.priority-media{ border-color: color-mix(in srgb, #d6ab3b 45%, var(--border)); background: color-mix(in srgb, #d6ab3b 10%, var(--card-bg, var(--card))); }
.widget-link{ border:0; background:none; color:var(--accent-80); cursor:pointer; text-align:left; padding:0; font-weight:700; }
.upcoming-row--timeline{ align-items:center; }
.upcoming-date-block{ min-width:3rem; text-align:center; display:flex; flex-direction:column; }
.upcoming-date-month{ font-size:.72rem; color:var(--text-soft); text-transform:uppercase; letter-spacing:.05em; }
.upcoming-date-day{ font-size:1.3rem; color:var(--color-text); }
#volverListaProfesores{
  margin-bottom: 1rem;
}
