/* =========================================================
   Base
   ========================================================= */
:root{
  --surface-plain: rgba(var(--color-surface-rgb),0.98);
  --surface-strong: rgba(var(--color-primary-rgb),0.55);
  --surface-muted: rgba(var(--color-primary-rgb),0.22);
  --surface-card: rgba(var(--color-surface-rgb),0.94);
  --text-soft: rgba(var(--color-text-rgb),0.72);
  --text-faint: rgba(var(--color-text-rgb),0.6);
  --line-strong: rgba(var(--color-border-rgb),0.85);
  --line-soft: rgba(var(--color-border-rgb),0.55);
  --shadow: var(--shadow-strong);
}
/* =========================================================
   Layout
   ========================================================= */
header{
  padding:1rem 1.3rem;
  display:flex;
  justify-content:space-between;
  align-items:center;
  background:linear-gradient(120deg, rgba(255,255,255,.92), rgba(var(--color-primary-rgb),.55));
  box-shadow:0 12px 28px var(--shadow-color-strong);
  gap:.8rem;
  border-bottom:1px solid rgba(var(--color-border-rgb),.75);
  backdrop-filter: blur(10px);
}
.header-left{ display:flex; flex-direction:column; gap:.15rem; }
.header-title{ font-size:1.3rem; font-weight:800; letter-spacing:.2px; }
.header-sub{ font-size:.87rem; color:var(--muted); }
.header-right{ display:flex; align-items:center; gap:.75rem; flex-wrap:wrap; justify-content:flex-end; }
.user-panel{
  position:relative;
  display:flex;
  align-items:center;
  z-index: 1000;
}
.user-avatar{
  width:44px;
  height:44px;
  padding:0;
  border-radius:999px;
  border:1px solid rgba(var(--color-border-rgb),.85);
  background:var(--surface-card);
  box-shadow:0 10px 24px var(--shadow-color-soft);
  display:inline-flex;
  align-items:center;
  justify-content:center;
}
.user-avatar img{
  width:100%;
  height:100%;
  border-radius:inherit;
  object-fit:cover;
  display:block;
}
.user-menu{
  position:absolute;
  right:0;
  top:calc(100% + .55rem);
  min-width:190px;
  background:var(--surface-card);
  border:1px solid rgba(var(--color-border-rgb),.8);
  border-radius:var(--radius-lg);
  padding:.35rem;
  box-shadow:0 18px 32px var(--shadow-color-strong);
  opacity:0;
  transform:translateY(-8px);
  pointer-events:none;
  transition:opacity var(--transition-fast), transform var(--transition-fast);
  z-index:40;
}
.user-menu::before{
  content:"";
  position:absolute;
  top:-6px;
  right:18px;
  width:12px;
  height:12px;
  background:var(--surface-card);
  border-left:1px solid rgba(var(--color-border-rgb),.6);
  border-top:1px solid rgba(var(--color-border-rgb),.6);
  transform:rotate(45deg);
}
.user-panel.open .user-menu{
  opacity:1;
  transform:translateY(0);
  pointer-events:auto;
}
.user-menu button,
.user-menu a{
  width:100%;
  border:none;
  background:transparent;
  padding:.55rem .7rem;
  border-radius:var(--radius-md);
  color:var(--color-text);
  font-size:.9rem;
  text-align:left;
  display:flex;
  align-items:center;
  gap:.5rem;
  cursor:pointer;
}
.user-menu button:hover,
.user-menu a:hover{
  background:rgba(var(--color-accent-rgb),.12);
}
.user-menu .menu-icon{
  font-size:1rem;
  width:1.1rem;
  text-align:center;
}
.account-box{
  padding:.55rem .85rem;
  border-radius:var(--radius-lg);
  background:var(--surface-card);
  border:1px solid rgba(var(--color-border-rgb),.85);
  display:flex;
  flex-direction:column;
  gap:.12rem;
  min-width:240px;
  box-shadow:0 12px 32px var(--shadow-color-soft);
}
.account-label{ font-size:.76rem; color:var(--muted); letter-spacing:.1px; }
.account-email{
  font-size:.88rem;
  color:var(--color-text);
  max-width:260px;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
}

button{
  padding:.48rem 1.05rem;
  border:none;
  border-radius:var(--radius-md);
  cursor:pointer;
  font-size:.92rem;
  transition: transform var(--transition-fast), filter var(--transition-fast), box-shadow var(--transition-fast);
  user-select:none;
  letter-spacing:.05rem;
}
.btn-blue{
  background:linear-gradient(120deg,var(--accent),var(--accent-2));
  color:var(--color-primary-strong);
  box-shadow:0 10px 24px rgba(var(--color-accent-rgb),.25);
}
.btn-blue:hover{ filter:brightness(1.05); transform:translateY(-1px); }
.btn-gray{ background:var(--color-surface-2); color:var(--color-text); box-shadow:0 6px 16px var(--shadow-color-soft); }
.btn-gray:hover{ filter:brightness(1.05); transform:translateY(-1px); }
.btn-outline{
  background:var(--glass-faint);
  color:var(--color-text);
  border:1px solid rgba(var(--color-border-rgb),.9);
  box-shadow:0 10px 24px var(--shadow-color-soft);
}
.btn-outline:hover{ border-color:rgba(var(--color-accent-rgb),.85); }
.btn-danger{ background:var(--color-danger); color:var(--color-text-contrast);}
.btn-small{ padding:.24rem .68rem; font-size:.8rem; border-radius:var(--radius-sm);box-shadow: none; }

.section-label{
  display:inline-flex;
  align-items:center;
  gap:.5rem;
  font-weight:800;
  letter-spacing:.1px;
  background:var(--glass-faint);
  border:1px solid rgba(var(--color-border-rgb),.85);
  border-radius:var(--radius-md);
  padding:.55rem .85rem;
  color:var(--color-text);
  box-shadow:0 10px 24px var(--shadow-color-soft);
  width: fit-content;
}

.content-header{
  display:grid;
  grid-template-columns:auto 1fr auto;
  align-items:center;
  gap:.75rem;
  position:sticky;
  top:0;
  z-index:12;
  padding:.35rem .5rem;
  background:linear-gradient(120deg, rgba(255,255,255,.92), rgba(var(--color-primary-rgb),.5));
  border-radius:var(--radius-lg);
  border:1px solid rgba(var(--color-border-rgb),.6);
  box-shadow:0 12px 26px var(--shadow-color-soft);
}
.content-header .section-label{
  justify-self:center;
}
.help-btn{
  border:1px solid rgba(var(--color-accent-rgb),.75);
  background:linear-gradient(135deg, rgba(var(--color-accent-rgb),.35), rgba(var(--color-accent-rgb),.25));
  color:var(--color-primary-strong);
  width:42px;
  height:42px;
  border-radius:var(--radius-md);
  font-weight:800;
  font-size:1.05rem;
  box-shadow:0 12px 24px rgba(var(--color-accent-rgb),.25);
}
.help-btn:hover{ filter:brightness(1.05); }

.page-layout{
  --sidebar-expanded:240px;
  --sidebar-collapsed:96px;
  display:grid;
  grid-template-columns:var(--sidebar-expanded) minmax(0,1fr);
  gap:1.35rem;
  max-width:none;
  width:calc(100% - 2rem);
  margin:1.3rem auto 2rem;
  padding:0 1rem 0 1.2rem;
  align-items:flex-start;
  transition:grid-template-columns .18s ease;
}
.page-layout.sidebar-collapsed{
  grid-template-columns:var(--sidebar-collapsed) minmax(0,1fr);
}
.page-content{
  min-width:0;
  display:flex;
  flex-direction:column;
  margin-left: 0.9rem;
  gap:.75rem;
  z-index: -1;
}
.main-shell{ max-width:none; margin:0; padding:0; }
@media(max-width:1024px){
  .page-layout{ grid-template-columns:1fr; width:calc(100% - 1.6rem); padding:0 .8rem; }
}

    .tabs-bar{
      display:flex;
      gap:.5rem;
      margin-bottom:1rem;
      flex-wrap:wrap;
      align-items:center;
    }
    .tab-btn{
      flex:0 0 auto;
      padding:.5rem 1rem;
      border-radius:var(--radius-lg);
      background:var(--surface-card);
      color:var(--color-text);
      border:1px solid rgba(var(--color-border-rgb),.85);
      font-size:.9rem;
      box-shadow:0 6px 16px var(--shadow-color-strong);
      letter-spacing:.05rem;
    }
    .tab-btn.tab-active{
      background:linear-gradient(120deg,var(--accent),var(--accent-2));
      border-color:rgba(var(--color-accent-rgb),.85);
      box-shadow:0 10px 26px rgba(var(--color-accent-rgb),.35);
      color:var(--color-primary-strong);
      font-weight:800;
    }

    .tab-card{
      background: linear-gradient(180deg, rgba(255,255,255,0.95), rgba(var(--color-primary-rgb),0.35));
      border-radius:var(--radius-2xl);
      padding:1.05rem;
      box-shadow:0 18px 45px var(--shadow-color-deep);
      border:1px solid rgba(var(--color-border-rgb),.3);
      backdrop-filter: blur(8px);
    }
    .welcome-card{
      display:grid;
      grid-template-columns:minmax(0,2.1fr) minmax(0,1fr);
      gap:1rem;
      align-items:start;
    }
    @media(max-width:960px){
      .welcome-card{ grid-template-columns:1fr; }
    }
    .welcome-title{ margin:0.1rem 0; font-size:1.6rem; }
    .welcome-sub{
      color:var(--text-soft);
      max-width:780px;
      line-height:1.55;
    }
    .welcome-grid{
      margin-top:1rem;
      display:grid;
      gap:.75rem;
      grid-template-columns:repeat(auto-fit, minmax(220px,1fr));
    }
    .welcome-item{
      background:var(--glass-faint);
      border:1px solid rgba(var(--color-border-rgb),.14);
      border-radius:var(--radius-lg);
      padding:.85rem;
      box-shadow:0 10px 26px var(--shadow-color-soft);
    }
    .welcome-label{ font-weight:800; margin-bottom:.25rem; }
    .welcome-desc{ color:var(--text-soft); line-height:1.4; }
    .welcome-credits{
      background:linear-gradient(135deg, rgba(var(--color-accent-rgb),.22), rgba(var(--color-ok-rgb),.15));
      border:1px solid rgba(var(--color-accent-rgb),.35);
      border-radius:var(--radius-lg);
      padding:1rem;
      color:var(--color-primary-strong);
      box-shadow:0 16px 30px rgba(var(--color-accent-rgb),.25);
    }
    .welcome-credits-title{
      font-weight:800;
      font-size:1.05rem;
      margin-bottom:.25rem;
    }
    .welcome-credits-body{
      line-height:1.45;
      color:var(--color-primary-strong);
      font-weight:600;
    }

    .tab-estudio-layout{
      display:grid;
      grid-template-columns: minmax(0,2.2fr) minmax(0,1fr);
      gap:1rem;
    }
    @media(max-width:900px){ .tab-estudio-layout{ grid-template-columns:1fr; } }

    .calendar-container{
      background:var(--surface-card);
      border-radius:var(--radius-lg);
      padding:1rem;
      border:1px solid rgba(var(--color-border-rgb),.9);
      box-shadow:0 12px 32px var(--shadow-color-strong);
    }
    .calendar-header{
      display:flex;
      justify-content:space-between;
      align-items:center;
      margin-bottom:.7rem;
      gap:.6rem;
      flex-wrap:wrap;
    }
    .cal-left{
      display:flex; align-items:center; gap:.5rem; flex-wrap:wrap;
    }
    .cal-right{
      display:flex; align-items:center; gap:.5rem; flex-wrap:wrap; justify-content:flex-end;
    }
    #monthTitle, #acadMonthTitle{ font-size:1.05rem; font-weight:700; letter-spacing:.2px; }
    .cal-nav-btn{
      padding:.35rem .7rem;
      border-radius:var(--radius-sm);
      background:var(--surface-plain);
      color:var(--color-text);
      border:1px solid var(--line-strong);
      font-size:.86rem;
      box-shadow:0 6px 14px var(--shadow-color-soft);
    }
    .cal-nav-btn:hover{ border-color:var(--color-accent-2); filter:brightness(1.05); }

    .grid{ display:grid; grid-template-columns:repeat(7,1fr); gap:8px; }
    .dow{
      font-size:.78rem;
      color:var(--color-muted);
      text-align:center;
      padding:.25rem 0;
    }

    /* ===== ESTUDIO (fijo y simple) ===== */
    .day{
      min-height:96px;
      background:var(--color-surface-3);
      border-radius:var(--radius-md);
      padding:8px 8px 6px;
      cursor:pointer;
      font-size:.9rem;
      position:relative;
      border:1px solid rgba(var(--color-border-rgb),.9);
    }
    .day:hover{ border-color:rgba(var(--color-accent-rgb),.8); }
    .day-number{
      display:flex;
      align-items:center;
      justify-content:space-between;
      color:var(--text-soft);
      font-weight:800;
      gap:.45rem;
    }
    .today-dot{
      width:8px; height:8px; border-radius:50%;
      background:var(--color-accent-2);
      opacity:0;
      transition:opacity .2s ease;
    }
    .day.is-today .today-dot{ opacity:1; }
    .day-muted{
      background:var(--surface-muted);
      border:1px dashed rgba(var(--color-border-rgb),.6);
      cursor:default;
    }
    .event{
      background:rgba(var(--color-accent-rgb),.35);
      border:1px solid rgba(var(--color-accent-rgb),.55);
      color:var(--color-primary-strong);
      padding:5px 6px;
      border-radius:var(--radius-sm);
      font-size:.82rem;
      margin-top:6px;
      box-shadow:0 8px 18px var(--shadow-color-soft);
    }

    /* ESTAD√çSTICAS */
    .stats-card{
      background:var(--surface-card);
      border-radius:var(--radius-lg);
      padding:.9rem;
      border:1px solid rgba(var(--color-border-rgb),.85);
      box-shadow:0 12px 30px var(--shadow-color-soft);
    }
    .stats-title{ font-weight:700; margin-bottom:.4rem; }
    .stats-item{ color:var(--color-text); margin-bottom:.3rem; }

    /* MODAL ESTUDIO */
    .modal-bg{
      position:fixed;
      inset:0;
      background:var(--overlay-strong);
      display:none;
      align-items:center;
      justify-content:center;
      z-index:1200;
      padding:1rem;
    }
    .modal{
      background:linear-gradient(180deg, rgba(255,255,255,0.96), rgba(var(--color-primary-rgb),0.6));
      border-radius:var(--radius-xl);
      padding:1rem;
      min-width:320px;
      max-width:640px;
      width:100%;
      border:1px solid rgba(var(--color-border-rgb),.35);
      box-shadow:0 18px 48px var(--shadow-color-deep);
    }
    .modal h3{ margin-top:0; margin-bottom:.8rem; }
    .modal input, .modal textarea, .modal select{
      width:100%;
      margin-bottom:.6rem;
      padding:.65rem .75rem;
      border-radius:var(--radius-md);
      border:1px solid rgba(var(--color-border-rgb),.6);
      background:var(--color-surface-3);
      color:var(--color-text);
      box-shadow:inset 0 1px 0 var(--glass-soft);
      font-size:.95rem;
      box-sizing: border-box;
    }
    .modal textarea{ min-height:90px; resize:vertical; }
    .pwd-wrap{ position:relative; }
    .pwd-toggle{
      position:absolute;
      right:10px; top:50%;
      transform:translateY(-50%);
      padding:.3rem .45rem;
      font-size:.85rem;
      border-radius:var(--radius-sm);
    }
    .modal-help{
      max-width:720px;
      background:linear-gradient(180deg, rgba(255,255,255,0.96), rgba(var(--color-primary-rgb),0.6));
      border:1px solid rgba(var(--color-accent-rgb),.38);
      box-shadow:0 22px 60px var(--shadow-color-deep);
    }
    .help-modal-body{
      background:var(--color-surface-3);
      border:1px solid rgba(var(--color-border-rgb),.5);
      border-radius:var(--radius-md);
      padding:.75rem .85rem;
      line-height:1.45;
      color:var(--color-text);
      box-shadow:inset 0 1px 0 var(--glass-strong), 0 12px 36px var(--shadow-color-strong);
    }
    .help-section-title{
      font-weight:800;
      margin-bottom:.35rem;
      color:var(--color-text);
    }
    .help-list{
      margin:0;
      padding-left:1.1rem;
      color:var(--text-soft);
    }
    .help-list li{ margin-bottom:.25rem; }
    .help-modal-actions{
      display:flex;
      justify-content:flex-end;
      gap:.5rem;
      margin-top:.8rem;
    }

    /* TAB ACADEMICO */
    .acad-layout{
      display:grid;
      grid-template-columns:minmax(0,1.7fr) minmax(0,1fr);
      gap:1rem;
    }
    @media(max-width:980px){ .acad-layout{ grid-template-columns:1fr; } }
    .acad-shell,
    .acad-detail,
    .planner-box{
      background:var(--surface-card);
      border-radius:var(--radius-md);
      border:1px solid rgba(var(--color-border-rgb),.85);
      padding:.95rem;
      box-shadow:0 12px 30px var(--shadow-color-soft);
    }
    .acad-help{
      font-size:.9rem;
      color:var(--text-soft);
      line-height:1.35;
      margin-bottom:.55rem;
    }
    .acad-day-list{
      display:flex;
      flex-direction:column;
      gap:.4rem;
      margin-top:.4rem;
    }
    .acad-day-item{
      display:grid;
      grid-template-columns:auto 1fr auto;
      gap:.6rem;
      align-items:center;
      padding:.55rem .65rem;
      border-radius:var(--radius-md);
      background:var(--color-surface-3);
      border:1px solid var(--line-strong);
      box-shadow:0 8px 22px var(--shadow-color-soft);
      cursor:pointer;
    }
    .acad-day-item:hover{ border-color:rgba(var(--color-accent-rgb),.5); }
    .acad-item-left{ display:flex; align-items:center; gap:.35rem; flex-wrap:wrap; }
    .acad-item-title{
      font-weight:700;
      font-size:.95rem;
    }
    .acad-item-meta{
      color:var(--text-soft);
      font-size:.82rem;
    }
    .acad-item-right{
      font-size:.85rem;
      color:var(--text-soft);
    }
    .acad-detail-top{
      display:flex;
      justify-content:space-between;
      gap:.6rem;
      align-items:flex-start;
      flex-wrap:wrap;
      margin-bottom:.4rem;
    }
    .acad-detail-title{
      font-weight:800;
      letter-spacing:.1px;
    }
    .acad-detail-sub{
      color:var(--color-muted);
      font-size:.86rem;
    }
    .acad-detail-list{
      display:flex;
      flex-direction:column;
      gap:.45rem;
    }
    .acad-detail-row{
      display:grid;
      grid-template-columns:1fr auto;
      gap:.55rem;
      align-items:flex-start;
      padding:.6rem .7rem;
      border-radius:var(--radius-md);
      background:var(--color-surface-3);
      border:1px solid var(--line-strong);
      box-shadow:0 8px 20px var(--shadow-color-soft);
    }
    .acad-detail-text{
      min-width:0;
    }
    .acad-detail-text strong{
      display:block;
      font-size:.9rem;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .acad-detail-meta{
      font-size:.82rem;
      color:var(--color-muted);
      margin-top:.15rem;
      line-height:1.25;
    }
    .acad-detail-notes{
      margin-top:.35rem;
      font-size:.84rem;
      color:var(--text-soft);
      line-height:1.25;
      white-space:pre-wrap;
    }
    .acad-detail-actions{
      display:flex;
      gap:.35rem;
      flex-wrap:wrap;
      justify-content:flex-end;
      flex:0 0 auto;
    }
    .acad-next-row{
      font-size:.88rem;
      color:var(--color-text);
      margin-bottom:.25rem;
    }
    .acad-detail-empty{
      color:var(--text-soft);
      font-size:.9rem;
      padding:.35rem 0;
    }
    .day.is-selected{
      border-color:rgba(var(--color-accent-rgb),.6);
      box-shadow:0 0 0 1px rgba(var(--color-accent-rgb),.2), 0 10px 28px rgba(var(--color-accent-rgb),.25);
    }
    .badge-soft{
      display:inline-flex;
      align-items:center;
      padding:.12rem .55rem;
      border-radius:var(--radius-pill);
      border:1px solid var(--line-strong);
      background:var(--surface-muted);
      font-size:.75rem;
      color:var(--color-muted);
    }

    /* AGENDA SEMANAL */
    .agenda-header{
      display:flex;
      justify-content:space-between;
      align-items:center;
      margin-bottom:.6rem;
      gap:.6rem;
      flex-wrap:wrap;
    }
    .agenda-actions{
      display:flex;
      gap:.6rem;
      flex-wrap:wrap;
      align-items:center;
      justify-content:flex-end;
      width:100%;
    }
    .agenda-downloads{
      display:flex;
      gap:.35rem;
      flex-wrap:wrap;
    }
    .agenda-shell{
      grid-column: 1 / -1;
      background:var(--surface-card);
      border-radius:var(--radius-lg);
      border:1px solid rgba(var(--color-border-rgb),.85);
      padding:.5rem;
      overflow:auto;
      box-shadow:0 14px 34px var(--shadow-color-strong);
    }
    .agenda-grid{
      display:grid;
      grid-template-columns:70px repeat(6,1fr);
      font-size:.8rem;
      min-width:660px;
      position:relative;
    }
    .agenda-hour-spacer{
      height:34px;
      border-bottom:1px solid var(--line-strong);
    }
    .agenda-hour-col{ display:flex; flex-direction:column; }
    .agenda-hour{
      height:40px;
      border-bottom:1px dashed var(--line-strong);
      padding-right:.3rem;
      text-align:right;
      color:var(--text-soft);
      display:flex;
      align-items:flex-end;
      justify-content:flex-end;
      padding-bottom:6px;
    }
    .agenda-day-col{ border-left:1px solid var(--line-strong); position:relative; }
    .agenda-day-header{
      position:sticky;
      top:0;
      background:var(--surface-plain);
      text-align:center;
      padding:.25rem 0;
      font-weight:800;
      border-bottom:1px solid var(--line-strong);
      z-index:3;
    }
    .agenda-day-inner{ position:relative; }
    .agenda-line{
      position:absolute;
      left:0; right:0;
      height:1px;
      background:var(--surface-muted);
      opacity:.7;
    }
    .class-block{
      position:absolute;
      left:4px; right:4px;
      border-radius:var(--radius-sm);
      padding:4px 6px;
      color:var(--color-primary-strong);
      font-size:.75rem;
      box-shadow:0 10px 28px var(--shadow-color-deep);
      border:1px solid rgba(var(--color-accent-rgb),.65);
      cursor:pointer;
      overflow:hidden;
      background:linear-gradient(120deg,var(--accent),var(--accent-2));
      font-weight:700;
    }
    .class-block strong{ display:block; font-size:.78rem; }
    .class-block small{ display:block; font-size:.72rem; opacity:.95; }

    /* TAB MATERIAS */
    .subjects-layout{
      display:grid;
      grid-template-columns:minmax(0,1.4fr) minmax(0,1fr);
      gap:1rem;
    }
    @media(max-width:820px){ .subjects-layout{ grid-template-columns:1fr; } }
    .subjects-list-box, .subject-form-box{
      background:var(--surface-card);
      border-radius:var(--radius-md);
      border:1px solid rgba(var(--color-border-rgb),.85);
      padding:1rem;
      box-shadow:0 14px 32px var(--shadow-color-soft);
      position:relative;
      overflow:hidden;
    }
    .subjects-list-box::before, .subject-form-box::before{
      content:"";
      position:absolute;
      inset:0 0 auto 0;
      height:4px;
      background:linear-gradient(90deg, rgba(var(--color-accent-rgb),.65), rgba(59,130,246,.35), transparent);
      opacity:.6;
      pointer-events:none;
    }
    .subjects-list-header, .subject-form-header{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:.6rem;
      margin-bottom:.75rem;
    }
    .subjects-list{
      display:flex;
      flex-direction:column;
      gap:.5rem;
      margin-top:.2rem;
    }
    .subjects-empty-msg{
      font-size:.85rem;
      color:var(--color-muted-2);
      background:var(--color-surface-3);
      border-radius:var(--radius-sm);
      border:1px dashed var(--line-strong);
      padding:.65rem .7rem;
      margin-top:.6rem;
    }
    .subject-row{
      display:flex;
      align-items:center;
      gap:.6rem;
      background:var(--color-surface-3);
      border-radius:var(--radius-md);
      border:1px solid var(--line-strong);
      padding:.6rem .75rem;
      box-shadow:0 10px 24px var(--shadow-color-soft);
      transition:transform .15s ease, box-shadow .15s ease, border-color .15s ease;
    }
    .subject-row:hover{
      transform:translateY(-1px);
      border-color:rgba(var(--color-accent-rgb),.5);
      box-shadow:0 14px 28px var(--shadow-color-soft);
    }
    .subject-color-dot{
      width:18px; height:18px; border-radius:50%;
      border:1px solid rgba(var(--color-primary-rgb),.9);
    }
    .subject-name{ flex:1; font-size:.92rem; font-weight:600; }
    .subject-actions{ display:flex; gap:.35rem; }
    .subject-form-field{
      display:flex;
      flex-direction:column;
      gap:.35rem;
      margin-bottom:.7rem;
    }
    .subject-form-field label{
      font-size:.82rem;
      color:var(--color-muted-2);
      font-weight:600;
    }
    .subject-form-box select,
    .subject-form-box input[type="text"]{
      padding:.75rem 1rem;
      border-radius:999px;
      border:1px solid rgba(var(--color-border-rgb),.85);
      background:var(--color-surface-3);
      font-size:.95rem;
      transition:border-color .2s ease, box-shadow .2s ease, transform .2s ease;
    }
    .subject-form-box select:focus,
    .subject-form-box input[type="text"]:focus{
      border-color:rgba(var(--color-accent-rgb),.8);
      box-shadow:0 0 0 3px rgba(var(--color-accent-rgb),.2);
      transform:translateY(-1px);
    }
    .subject-color-row{
      display:flex;
      flex-direction:column;
      align-items:flex-start;
      gap:.55rem;
      position:relative;
      background:var(--color-surface-3);
      border:1px solid var(--line-strong);
      border-radius:var(--radius-md);
      padding:.7rem .8rem;
      box-shadow:inset 0 1px 0 var(--glass-strong);
    }
    .subject-color-palette{
      display:flex;
      gap:.5rem;
      flex-wrap:wrap;
    }
    .subject-color-swatch{
      width:34px;
      height:34px;
      border-radius:50%;
      border:2px solid transparent;
      background:var(--color-surface-3);
      cursor:pointer;
      box-shadow:0 8px 18px var(--shadow-color-soft);
      transition:transform .15s ease, box-shadow .15s ease, border-color .15s ease;
    }
    .subject-color-swatch[data-color]{
      background:var(--swatch-color, transparent);
    }
    .subject-color-swatch:hover{
      transform:translateY(-1px) scale(1.03);
      box-shadow:0 12px 22px var(--shadow-color-soft);
    }
    .subject-color-swatch.is-selected{
      border-color:rgba(var(--color-accent-rgb),.9);
      box-shadow:0 0 0 3px rgba(var(--color-accent-rgb),.25), 0 12px 24px var(--shadow-color-soft);
    }
    .subject-color-swatch--custom{
      background:conic-gradient(#ff4d4d, #ff9f1a, #ffe66d, #2ec4b6, #4c7dff, #8a7ff0, #e377c2, #ff4d4d);
      display:flex;
      align-items:center;
      justify-content:center;
      position:relative;
    }
    .subject-color-swatch__custom{
      width:60%;
      height:60%;
      border-radius:50%;
      border:2px solid rgba(255,255,255,.9);
      box-shadow:0 6px 12px rgba(0,0,0,.18);
      background:#fff;
    }
    .subject-color-input{
      position:absolute;
      opacity:0;
      pointer-events:none;
      width:1px;
      height:1px;
    }
    .subject-color-manual{
      display:flex;
      flex-direction:column;
      gap:.35rem;
      margin-top:.2rem;
    }
    .subject-color-text{
      border-radius:999px;
    }
    .subject-color-text.is-invalid{
      border-color:rgba(239,68,68,.7);
      box-shadow:0 0 0 3px rgba(239,68,68,.18);
    }
    .subject-color-text.is-valid{
      border-color:rgba(34,197,94,.6);
      box-shadow:0 0 0 3px rgba(34,197,94,.18);
    }
    .subject-color-hint{
      font-size:.78rem;
      color:var(--color-muted-2);
    }
    .subject-form-actions{
      margin-top:.2rem;
      display:flex;
      gap:.5rem;
      justify-content:flex-end;
    }
    .subject-form-note{
      margin-top:.75rem;
      font-size:.8rem;
      color:var(--color-muted-2);
      background:rgba(var(--color-accent-rgb),.08);
      border-radius:var(--radius-sm);
      padding:.55rem .65rem;
      border:1px solid rgba(var(--color-accent-rgb),.2);
    }

    /* TAB PERFIL */
    .profile-layout{
      display:grid;
      grid-template-columns:minmax(0,1.2fr) minmax(0,1fr);
      gap:1rem;
    }
    @media(max-width:980px){ .profile-layout{ grid-template-columns:1fr; } }
    .profile-card{
      background:var(--surface-card);
      border-radius:var(--radius-lg);
      border:1px solid rgba(var(--color-border-rgb),.85);
      padding:1rem;
      box-shadow:0 14px 32px var(--shadow-color-soft);
    }
    .profile-header{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:.6rem;
      margin-bottom:.8rem;
    }
    .profile-email{
      font-size:.85rem;
      color:var(--color-muted-2);
      padding:.35rem .6rem;
      border-radius:var(--radius-sm);
      background:var(--color-surface-3);
      border:1px solid var(--line-strong);
    }
    .profile-grid{
      display:grid;
      grid-template-columns:repeat(2, minmax(0,1fr));
      gap:.75rem;
    }
    @media(max-width:720px){ .profile-grid{ grid-template-columns:1fr; } }
    .profile-field{
      display:flex;
      flex-direction:column;
      gap:.35rem;
    }
    .profile-field-wide{ grid-column:1 / -1; }
    .profile-field label{
      font-size:.82rem;
      color:var(--color-muted-2);
      font-weight:600;
    }
    .profile-actions{
      margin-top:.9rem;
      display:flex;
      align-items:center;
      gap:.75rem;
      flex-wrap:wrap;
    }
    .profile-status{
      font-size:.85rem;
      color:var(--color-muted-2);
    }
    .profile-security{
      display:flex;
      flex-direction:column;
      gap:.6rem;
    }

    /* TAB PLANIFICADOR */
    .planner-layout{
      display:grid;
      grid-template-columns:minmax(0,1.35fr) minmax(0,1fr);
      gap:1rem;
    }
    @media(max-width:980px){ .planner-layout{ grid-template-columns:1fr; } }
    .planner-toolbar{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:.6rem;
      flex-wrap:wrap;
    }
    .planner-toolbar-left{
      display:flex;
      align-items:center;
      gap:.5rem;
    }
    .planner-toolbar-right{
      display:flex;
      align-items:center;
      gap:.5rem;
      flex-wrap:wrap;
    }
    .planner-list{
      display:flex;
      flex-direction:column;
      gap:.5rem;
      margin-top:.6rem;
      max-height:360px;
      overflow:auto;
    }
    .section-card{
      background:var(--color-surface-3);
      border-radius:var(--radius-md);
      border:1px solid var(--line-strong);
      box-shadow:0 8px 22px var(--shadow-color-soft);
      padding:.7rem .75rem;
      display:flex;
      flex-direction:column;
      gap:.45rem;
    }
    .section-card-top{
      display:flex;
      justify-content:space-between;
      gap:.6rem;
      align-items:flex-start;
      flex-wrap:wrap;
    }
    .section-title{
      font-weight:800;
      font-size:.95rem;
    }
    .section-sub{
      color:var(--text-soft);
      font-size:.82rem;
    }
    .section-actions{
      display:flex;
      gap:.4rem;
      flex-wrap:wrap;
      justify-content:flex-end;
    }
    .section-days{
      display:flex;
      gap:.35rem;
      flex-wrap:wrap;
    }
    .pill{
      display:inline-flex;
      align-items:center;
      padding:.2rem .55rem;
      border-radius:var(--radius-pill);
      background:var(--glass-soft);
      color:var(--color-text);
      font-size:.8rem;
      border:1px solid rgba(var(--color-border-rgb),.18);
    }
    .pill-muted{
      color:var(--text-soft);
      border-color:rgba(var(--color-border-rgb),.1);
      background:var(--surface-muted);
    }
    .preset-item{
      display:flex;
      justify-content:space-between;
      align-items:flex-start;
      gap:.5rem;
      padding:.55rem .6rem;
      border-radius:var(--radius-md);
      background:var(--color-surface-3);
      border:1px solid var(--line-strong);
      margin-bottom:.4rem;
      box-shadow:0 8px 20px var(--shadow-color-soft);
    }
    .preset-item.active{
      border-color:rgba(var(--color-accent-rgb),.6);
      box-shadow:0 8px 24px rgba(var(--color-accent-rgb),.35);
    }
    .preset-name{
      font-weight:800;
    }
    .preset-meta{
      color:var(--text-soft);
      font-size:.82rem;
      margin-top:.1rem;
    }
    .preset-row{
      display:flex;
      gap:.4rem;
      flex-wrap:wrap;
    }
    .input-mini{
      padding:.48rem .65rem;
      border-radius:var(--radius-md);
      border:1px solid rgba(var(--color-border-rgb),.6);
      background:var(--color-surface-3);
      color:var(--color-text);
      box-shadow:inset 0 1px 0 var(--glass-soft);
      font-size:.9rem;
    }
    .badge{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      padding:.25rem .6rem;
      border-radius:var(--radius-sm);
      background:rgba(var(--color-accent-rgb),.15);
      border:1px solid rgba(var(--color-accent-rgb),.4);
      color:var(--color-text);
      font-weight:800;
      font-size:.8rem;
    }

/* ===== PROFESORES ===== */
.prof-layout{
  display:grid;
  grid-template-columns: minmax(0,1.2fr) minmax(0,0.8fr);
  gap:1rem;
}
@media(max-width:1000px){
  .prof-layout{ grid-template-columns:1fr; }
}
.prof-list-panel, .prof-detail-panel{
  display:flex;
  flex-direction:column;
  gap:.75rem;
}
.prof-header{
  display:flex;
  justify-content:space-between;
  align-items:flex-start;
  gap:1rem;
  flex-wrap:wrap;
}
.prof-filters{
  display:flex;
  gap:.6rem;
  flex-wrap:wrap;
}
.prof-filters select{
  background:var(--color-surface-3);
  border:1px solid rgba(var(--color-border-rgb),.8);
  color:var(--color-text);
  border-radius:10px;
  padding:.45rem .65rem;
  min-width:160px;
}
.prof-list{
  display:flex;
  flex-direction:column;
  gap:.65rem;
}
.prof-card{
  background:var(--surface-card);
  border:1px solid rgba(var(--color-border-rgb),.35);
  border-radius:var(--radius-lg);
  padding:.85rem;
  box-shadow:0 12px 28px var(--shadow-color-soft);
  cursor:pointer;
  transition:transform .12s ease, border-color .12s ease;
}
.prof-card:hover{ transform:translateY(-1px); border-color:rgba(var(--color-accent-rgb),.45); }
.prof-card.active{ border-color:rgba(var(--color-accent-rgb),.65); box-shadow:0 16px 36px rgba(var(--color-accent-rgb),.25); }
.prof-card-title{
  font-size:1rem;
  font-weight:800;
}
.prof-card-row{
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap:.5rem;
  flex-wrap:wrap;
}
.prof-card-meta{ color:var(--muted); font-size:.9rem; }
.prof-badges{ display:flex; gap:.35rem; flex-wrap:wrap; margin-top:.3rem; }
.prof-badge{
  background:var(--glass-faint);
  border:1px solid rgba(var(--color-border-rgb),.22);
  padding:.18rem .45rem;
  border-radius:var(--radius-sm);
  font-size:.82rem;
  color:var(--text-soft);
}
.prof-detail-card{
  background:var(--surface-card);
  border:1px solid rgba(var(--color-border-rgb),.35);
  border-radius:var(--radius-lg);
  padding:1rem;
  box-shadow:0 16px 38px var(--shadow-color-deep);
}
.prof-detail-head{
  display:flex;
  justify-content:space-between;
  gap:.75rem;
  flex-wrap:wrap;
  align-items:flex-start;
}
.prof-detail-name{ font-size:1.15rem; font-weight:800; }
.prof-detail-meta{ color:var(--muted); font-size:.9rem; }
.prof-score{
  text-align:right;
}
.prof-score-big{
  font-size:1.6rem;
  font-weight:800;
}
.stars{
  display:flex;
  gap:.1rem;
  align-items:center;
}
.star{ color:var(--color-primary-soft); font-size:1rem; }
.star.full{ color:var(--color-accent); text-shadow:0 0 12px rgba(var(--color-accent-rgb),.45); }
.prof-criteria-grid{
  display:grid;
  grid-template-columns:repeat(3,minmax(0,1fr));
  gap:.6rem;
  margin-top:.8rem;
}
@media(max-width:760px){
  .prof-criteria-grid{ grid-template-columns:1fr; }
}
.prof-criteria{
  background:var(--glass-faint);
  border:1px solid rgba(var(--color-border-rgb),.2);
  border-radius:var(--radius-md);
  padding:.75rem;
}
.prof-comments{
  margin-top:.9rem;
  display:flex;
  flex-direction:column;
  gap:.45rem;
}
.prof-comment{
  background:var(--glass-faint);
  border:1px solid rgba(var(--color-border-rgb),.16);
  border-radius:var(--radius-md);
  padding:.7rem;
}
.prof-comment-head{
  display:flex;
  justify-content:space-between;
  align-items:flex-start;
  gap:.5rem;
  flex-wrap:wrap;
}
.prof-rate-card{
  background:var(--surface-card);
  border:1px solid rgba(var(--color-border-rgb),.35);
  border-radius:var(--radius-lg);
  padding:1rem;
  box-shadow:0 16px 38px var(--shadow-color-deep);
}
.prof-rate-grid{
  display:grid;
  grid-template-columns:repeat(3,minmax(0,1fr));
  gap:.6rem;
  margin-bottom:.65rem;
}
@media(max-width:760px){
  .prof-rate-grid{ grid-template-columns:1fr; }
}
.prof-rate-field{
  background:var(--glass-faint);
  border:1px solid rgba(var(--color-border-rgb),.16);
  border-radius:var(--radius-md);
  padding:.65rem;
}
.prof-rate-value{ color:var(--muted); margin-top:.2rem; }
.prof-rate-title{ margin:0 0 .35rem; }
.prof-rate-card textarea{
  width:100%;
  min-height:88px;
  background:var(--color-surface-3);
  border:1px solid rgba(var(--color-border-rgb),.4);
  color:var(--color-text);
  border-radius:var(--radius-sm);
  padding:.6rem;
  font-family:inherit;
}
.prof-rate-check{
  display:flex;
  gap:.4rem;
  align-items:center;
  margin-top:.35rem;
  color:var(--text-soft);
  font-size:.9rem;
}

.muted{ color:var(--text-soft); font-size:.9rem; }

/* ===== MENSAJES ===== */
.messenger-dock{
  position:fixed;
  right:0.75rem;
  top:96px;
  bottom:0.75rem;
  max-width:480px;
  width:min(480px, 95vw);
  z-index:50;
}
.messenger-panel{
  height:100%;
  background:var(--surface-card);
  border:1px solid rgba(var(--color-border-rgb),.35);
  border-radius:var(--radius-2xl);
  box-shadow:0 24px 60px var(--shadow-color-deep);
  padding:.85rem;
  display:flex;
  flex-direction:column;
  gap:.75rem;
  backdrop-filter: blur(10px);
  transition:transform .2s ease, opacity .2s ease;
}
.messenger-dock.collapsed .messenger-panel{
  transform:translateX(110%);
  opacity:.25;
  pointer-events:none;
}
.messenger-toggle{
  position:absolute;
  left:-48px;
  top:1rem;
  width:42px;
  height:42px;
  border-radius:var(--radius-md);
  border:1px solid rgba(var(--color-border-rgb),.28);
  background:linear-gradient(120deg, rgba(var(--color-accent-rgb),.18), rgba(var(--color-accent-rgb),.12));
  color:var(--color-text);
  cursor:pointer;
  box-shadow:0 10px 24px var(--shadow-color-soft);
}
.messenger-head{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:.6rem;
  flex-wrap:wrap;
}
.messenger-title{
  display:flex;
  gap:.6rem;
  align-items:center;
}
.messenger-actions{ display:flex; gap:.4rem; }
.messenger-icon{
  width:42px;
  height:42px;
  border-radius:14px;
  background:rgba(var(--color-accent-rgb),.16);
  border:1px solid rgba(var(--color-accent-rgb),.4);
  display:grid;
  place-items:center;
  font-size:1.1rem;
}
.messenger-heading{ font-weight:800; font-size:1rem; }
.messenger-sub{ color:var(--color-muted); font-size:.88rem; }
.messenger-grid{
  display:grid;
  grid-template-columns: 1fr 1.15fr;
  gap:.75rem;
  height:100%;
}
@media(max-width:1200px){
  .messenger-grid{ grid-template-columns:1fr; height:auto; }
}
.messenger-left, .messenger-right{
  display:flex;
  flex-direction:column;
  gap:.75rem;
}
.card-block, .chat-card{
  background:var(--surface-card);
  border:1px solid rgba(var(--color-border-rgb),.3);
  border-radius:14px;
  padding:.85rem;
  box-shadow:0 10px 26px var(--shadow-color-soft);
}
.block-title{
  font-weight:700;
  margin-bottom:.35rem;
  letter-spacing:.1px;
}
.friend-form{
  display:flex;
  gap:.5rem;
  margin-top:.35rem;
  flex-wrap:wrap;
}
.friend-form input{
  flex:1;
  min-width:200px;
  padding:.55rem .7rem;
  border-radius:10px;
  border:1px solid rgba(var(--color-border-rgb),.5);
  background:var(--color-surface-3);
  color:var(--color-text);
}
.requests-box, .friends-box, .messages-box{
  display:flex;
  flex-direction:column;
  gap:.6rem;
}
.requests-group, .friends-group{ margin-top:.4rem; }
.friends-sections{
  display:flex;
  flex-direction:column;
  gap:.5rem;
}
.requests-group:not(:first-child){
  padding-top:.45rem;
  border-top:1px dashed rgba(var(--color-border-rgb),.2);
}
.requests-header, .friends-header{
  font-size:.86rem;
  color:var(--text-soft);
  margin-bottom:.35rem;
  letter-spacing:.05rem;
}
.request-card{
  display:flex;
  justify-content:space-between;
  align-items:flex-start;
  border:1px solid rgba(var(--color-border-rgb),.18);
  padding:.6rem .75rem;
  border-radius:12px;
  background:var(--glass-faint);
  gap:.4rem;
}
.req-email{ font-weight:700; }
.req-meta{ color:var(--text-soft); font-size:.85rem; }
.req-actions{ display:flex; gap:.45rem; }
.friends-box .muted, .requests-box .muted, .messages-box .muted{
  color:var(--text-soft);
  font-size:.9rem;
}
.friend-row{
  display:flex;
  justify-content:space-between;
  align-items:center;
  border:1px solid rgba(var(--color-border-rgb),.18);
  padding:.55rem .7rem;
  border-radius:12px;
  background:var(--glass-faint);
  transition:border-color .12s ease, box-shadow .12s ease;
}
.friend-row.friend-online{
  border-color:rgba(var(--color-ok-rgb),.5);
  box-shadow:0 8px 18px rgba(var(--color-ok-rgb),.18);
}
.friend-name{ font-weight:700; }
.friend-meta{ color:var(--text-soft); font-size:.85rem; display:flex; gap:.45rem; align-items:center; }
.status-dot{
  width:10px;
  height:10px;
  border-radius:999px;
  background:rgba(var(--color-border-rgb),.8);
  box-shadow:0 0 0 4px rgba(var(--color-border-rgb),.12);
}
.status-dot.online{
  background:var(--color-ok);
  box-shadow:0 0 0 4px rgba(var(--color-ok-rgb),.12);
}
.chat-card{ flex:1; display:flex; flex-direction:column; gap:.65rem; }
.chat-header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap:.6rem;
  flex-wrap:wrap;
}
.chat-title{
  font-weight:800;
  font-size:1.05rem;
}
.chat-subtitle{ color:var(--text-soft); font-size:.9rem; }
.toggle-line{
  display:inline-flex;
  align-items:center;
  gap:.4rem;
  color:var(--text-soft);
  font-size:.9rem;
}
.messages-box{
  min-height:260px;
  max-height:420px;
  overflow:auto;
  border:1px solid rgba(var(--color-border-rgb),.3);
  border-radius:14px;
  padding:.75rem;
  background:var(--color-surface-3);
  box-shadow:inset 0 8px 24px var(--shadow-color-soft);
}
.msg-row{
  display:flex;
  margin-bottom:.5rem;
}
.msg-row.me{ justify-content:flex-end; }
.msg-bubble{
  max-width:80%;
  padding:.55rem .65rem;
  border-radius:14px;
  background:linear-gradient(120deg, rgba(var(--color-accent-rgb),.18), rgba(var(--color-accent-rgb),.12));
  border:1px solid rgba(var(--color-border-rgb),.2);
  box-shadow:0 8px 20px var(--shadow-color-soft);
}
.msg-row.other .msg-bubble{
  background:rgba(var(--color-border-rgb),.12);
}
.msg-text{ white-space:pre-wrap; }
.msg-meta{ color:var(--text-soft); font-size:.78rem; margin-top:.25rem; }
.chat-input-row{
  display:flex;
  gap:.5rem;
  margin-top:auto;
}
.chat-input-row input{
  flex:1;
  padding:.65rem .75rem;
  border-radius:12px;
  border:1px solid rgba(var(--color-border-rgb),.5);
  background:var(--color-surface-3);
  color:var(--color-text);
}
